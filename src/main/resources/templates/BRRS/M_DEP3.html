<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<!-- 
CREATED BY	: GOPIKA B
CREATED ON	: 16.09.2025
PURPOSE		: BRRSREPORT
-->

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSS -->
<link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
<link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
<link rel="stylesheet" type="text/css" th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
<link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
<link rel="stylesheet" th:href="@{/css/CustomButton.css}" />
<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon" />

<!-- JavaScript -->
<!-- jQuery core (required first) -->


<!-- ‚úÖ Your manually placed jQuery validation
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	 <script th:src="/jquery/jquery.validate.min.js"></script>
	 -->

<!-- jQuery (required first) -->
<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
<!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->

<!-- ‚úÖ jQuery Validation -->
<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
 th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>

<!-- Bootstrap + Others -->
<script th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
<script th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>
<script th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>


<style>
.btns {
	float: right;
	margin: 5px;
}

.col-sm-5 {
	padding-bottom: 15px;
}

.list-body {
	padding: 0px;
}

.error {
	color: red;
	padding-left: 10px;
}

.formline {
	padding-bottom: 15px;
}

.btn-primary {
	background-color: #E77400;
	border-color: #0c0c0c;
}

.btn-primary:not (:disabled ):not (.disabled ).active, .btn-primary:not
	 (:disabled ):not (.disabled ):active, .show>.btn-primary.dropdown-toggle
	{
	color: #fff;
	background-color: #cc000000;
	border-color: #161617;
}

#finusertb {
	width: 460px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
}
</style>




<style>
div span {
	font-weight: bold;
	color: white !important;
}

.card {
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	border-radius: 8px;
}

.card-header h5 {
	font-size: 22px;
	color: #fff;
	font-weight: 600;
}

.nav-tabs .nav-link {
	font-weight: 500;
	border: 1px solid #dee2e6;
	border-bottom: none;
	border-radius: 4px 4px 0 0;
	background-color: #f1f1f1;
	margin-right: 5px;
}

.nav-tabs .nav-link.active {
	background-color: #ffffff;
	border-color: #dee2e6 #dee2e6 #ffffff;
}

.table-responsive {
	border: 1px solid #dee2e6;
	border-radius: 4px;
}

.table-hover tbody tr:hover {
	background-color: #f3f6f9;
}

thead th {
	position: sticky;
	top: 0;
	background-color: #e9ecf0;
	z-index: 1;
}

.table td {
	background-color: #FFFFFF;
}

.card-footer {
	padding: 10px;
	border-top: 1px solid #ccc;
}

.btn-xs {
	padding: 4px 12px;
	font-size: 14px;
	border-radius: 4px;
}

#BRFvalidation th, #usertable td {
	vertical-align: middle;
	text-align: left;
	font-size: 16px;
	font-family: Arial;
}

.fa-edit:hover {
	color: #28a745;
	transform: scale(1.1);
}

td {
	border: 1px solid rgb(0, 164, 166);
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}
</style>


<style>
.form-group {
	position: relative;
	margin-bottom: 1.5rem;
}

.form-control {
	width: 100%;
	border: 2px solid #ccc;
	border-radius: 8px;
	font-size: 1rem;
	outline: none;
	background: transparent;
	transition: border-color 0.3s ease, padding-top 0.3s ease;
}

.error {
	color: red;
	padding-top: 15px;
}

.form-control:focus {
	border-color: #007bff;
}

.form-legend {
	position: absolute;
	top: 50%;
	left: 15px;
	transform: translateY(-50%);
	font-size: 1rem;
	color: #aaa;
	background: white;
	padding: 0 5px;
	pointer-events: none;
	transition: 0.3s ease;
}

/* When input or select is focused or has a value, move the label up */
.form-control:focus ~ .form-legend, .form-control:not (:placeholder-shown
	) ~ .form-legend {
	top: -8px;
	font-size: 1rem;
	color: #007bff;
}

/* Hover effect when the input/select is focused */
.form-control:focus:hover ~ .form-legend {
	color: #0056b3; /* Darker shade of blue on hover */
}

/* Ensure the label returns to the normal color after focus or hover is removed */
.form-control:not (:focus ) ~ .form-legend {
	color: #aaa; /* Normal label color */
}
</style>

<style>
/* Red border for invalid inputs */
input.error, select.error {
	border: 2px solid red !important;
}

/* Error message style */
label.error {
	color: red;
	font-size: 0.85em;
	margin-top: 5px;
	display: block;
}

.underline {
	text-decoration: underline;
	color: #08a6f1;
	cursor: pointer;
}

.left-arrow-circle {
	width: 35px;
	height: 35px;
	border-radius: 50%;
	background-color: white;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
	transition: background-color 0.3s, transform 0.2s;
}

.left-arrow-circle i {
	color: rgb(107, 122, 143);
}

.left-arrow-circle:hover {
	background-color: rgb(107, 122, 143);
	cursor: pointer;
	transform: scale(1.05);
	border: 2px solid white;
}

.left-arrow-circle:hover i {
	color: white;
}

.white-text span {
	color: white !important;
}

.table-cell tbody td:hover {
	background-color: #f0f0f0;
	/* Hover color for cell */
	cursor: pointer;
	/* Optional: pointer cursor */
}
</style>
<style>
#reports, #reports th, #reports td {
	border: 1px solid black !important;
}

#reports {
	border-collapse: collapse;
}
</style>

<style>
.header-bar {
	display: flex;
	align-items: center;
	flex-wrap: wrap; /* ‚úÖ allows wrapping on smaller screens */
	gap: 10px; /* spacing between elements */
	cursor: pointer;
}

/* üîò Circular arrow */
.left-arrow-circle {
	width: 35px;
	height: 35px;
	border-radius: 50%;
	background-color: white;
	color: #1f3a93;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.left-arrow-circle i {
	font-size: 18px;
}

/* üè∑Ô∏è Title */
.header-title {
	font-family: Arial, sans-serif;
	font-size: 20px;
	font-weight: bold;
	color: white;
	margin: 0;
	flex-shrink: 0;
}

/* üöå Bus display style box */
.boards {
	transform: translateY(6px);
	background-color: rgb(107, 122, 143);
	color: white;
	padding: 5px 5px;
	border-radius: 8px;
	overflow: hidden;
	white-space: nowrap;
	flex: 1; /* ‚úÖ makes it take available space dynamically */
	min-width: 190px;
	box-shadow: 0 0 10px rgb(107, 122, 143);
	position: relative;
}

/* ‚ú® Scrolling animation */
.scrolling-text {
	display: inline-block;
	font-family: "Courier New", monospace;
	font-weight: bold;
	letter-spacing: 1px;
	animation: scroll-left 10s linear infinite;
}

@
keyframes scroll-left { 0% {
	transform: translateX(100%);
}
100%
{
transform
:
 
translateX
(-100%);

			  
}
}
</style>



<script th:inline="javascript">

		$(document).ready(function () {
			// hide loader on normal load
			$('#loader').modal('hide');
		});

		$(window).on('pageshow', function () {
			// hide loader on back/forward nav
			$('#loader').modal('hide');
		});

		$(window).on('beforeunload', function () {
			// hide loader on leaving page
			$('#loader').modal('hide');
		});

				
		$(document).ready(function() {
			Maker_Checker_Function(); 
		});

		// if logged user is a Checker, checker cannot modify, if user is maker , then maker cant download
		function Maker_Checker_Function() {
			$.ajax({
				url: "/BRRS/getUserRole",    
				type: "GET",
				success: function(roleId) {
					// console.log("User Role ID:", roleId);
				
					if (roleId === "ADM-C" || roleId === "USR-C"  || roleId === "USER-AUDIT") {
						const modifyBtn = document.getElementById("addRecord");
						if (modifyBtn) modifyBtn.style.display = "none";
					}

					if (roleId === "ADM-M" || roleId === "USR-M") {
								const button = document.getElementById("custom-tab-btnAdd");
								if (button) button.style.display = "none";
							}

				},
				error: function(err) {
					console.error("Error fetching role:", err);
		¬†¬†¬†¬†¬†}
		¬†¬†¬†¬†});
		}




		function home() {
			$("#loader").modal("toggle");
			location.href = 'Dashboard'
		}

		function back() {
			$("#loader").modal("toggle");

			window.history.back();
		}

		//to fetch summary from the database - called from the summary button
		function showdetails() {

			var Callurl;
			$('#loader').modal('show');
			Callurl = /*[[@{'/Reports/'+${reportid}+'/Details'(asondate=${asondate},fromdate=${fromdate},todate=${todate},currency=${currency},dtltype=${dtltype},type=${type},version=${version})}]]*/
				location.href = Callurl;
			console.log(Callurl);

		}

		function showsummary() {
			$('#loader').modal('show');
			var Callurl = /*[[@{'/Reports/' + ${reportid} (dtltype='report', fromdate=${fromdate}, todate=${todate}, type=${type},version=${version}, asondate=${asondate})}]]*/
				location.href = Callurl;

		}
	</script>

<script>

		function activateTab(tabName) {
			// Remove 'active' from all buttons
			document.querySelectorAll('.custom-tab-btn').forEach(btn => {
				btn.classList.remove('active');
			});

			// Add 'active' to selected button
			if (tabName === 'summary') {
				document.getElementById('custom-tab-btnSummary').classList.add('active');
			} else if (tabName === 'Details') {
				document.getElementById('custom-tab-btnDetails').classList.add('active');
			}
		}

		window.onload = function () {
			/* setTimeout(function() {
				var selectedTab = document.getElementById("selectedTab").value;
				alert(selectedTab);
				activateTab(selectedTab);
			}, 10000); */ // 10,000 milliseconds = 10 seconds

			var selectedTab = document.getElementById("selectedTab").value;
			activateTab(selectedTab);
		};


		function downloadfile(button) {
		    var reportid = button.getAttribute('data-reportid');
		    var asondate = button.getAttribute('data-asondate');
		    var fromdate = button.getAttribute('data-fromdate');
		    var todate = button.getAttribute('data-todate');
		    var currency = button.getAttribute('data-currency');
		    var subreportid = button.getAttribute('data-subreportid');
		    var secid = button.getAttribute('data-secid');
		    var dtltype = button.getAttribute('data-dtltype');
		    var filename = button.getAttribute('data-filename');
			var type = button.getAttribute('data-type');
			var version = button.getAttribute('data-version');

		    $('#loader').modal('show');

		    $.ajax({
		        url: './downloadExcel?reportid=' + reportid +
		            '&fromdate=' + fromdate +
		            '&asondate=' + asondate +
		            '&todate=' + todate +
		            '&currency=' + currency +
		            '&subreportid=' + subreportid +
		            '&secid=' + secid +
		            '&filename=' + filename +
					'&type=' + type +
					'&version=' + version,
		        type: 'GET',
		        xhrFields: { responseType: 'blob' },

		        success: function (data) {
		            if (data && data.size > 100) {
		                const blob = new Blob([data], { type: 'application/vnd.ms-excel' });
		                const url = window.URL.createObjectURL(blob);
		                const a = document.createElement('a');

		                a.style.display = 'none';
		                a.href = url;
		                a.download = filename;

		                document.body.appendChild(a);
		                a.click();

		                window.URL.revokeObjectURL(url);
		                document.body.removeChild(a);

		                showResultModal('BRRS', filename + ' downloaded successfully.');
		            } else {
		                showResultModal('Information', 'No data was available to create a download.');
		            }
		        },

		        error: function (jqXHR, textStatus, errorThrown) {
		            console.error("Download failed:", textStatus, errorThrown);
		            showResultModal('Error', 'An error occurred while downloading the file. Please try again.');
		        },

		        complete: function () {
		            // üî• THIS ALWAYS RUNS (success or error or exceptions)
		            $('#loader').modal('hide');
		        }
		    });
		}


		function closemodel() {
			// Hide the modals
			$('#alert').modal('hide');
			$('#resultModal').modal('hide');

		}


		function showResultModal(title, message) {
			// Set the text for the modal elements
			$('#resultModalLabel').text(title);
			$('#resultModalBody').text(message);

			// Show the modal
			$('#resultModal').modal('show');
		}

	</script>
<script>

		function startReport(button) {
			const alertMsg = document.getElementById("alertMessage");
			const filename = button.getAttribute('data-filename');
			const fromdate = button.getAttribute('data-fromdate');
			const todate = button.getAttribute('data-todate');
			const currency = button.getAttribute('data-currency');
			const dtltype = button.getAttribute('data-dtltype');
			const type = button.getAttribute('data-type');
			const version = button.getAttribute('data-version');
			const sessionfilename = sessionStorage.getItem("filename");

			if (sessionfilename == filename) {
				alertMsg.innerHTML = 'Download request already Processing...';
				showAlert();
				return;
			}

			alertMsg.innerHTML = 'Download request Processing...';
			showAlert();

			const baseUrl = '/BRRS/Reports/startreport';
			const downloadUrl = baseUrl +
				'?filename=' + encodeURIComponent(filename) +
				'&fromdate=' + encodeURIComponent(fromdate) +
				'&todate=' + encodeURIComponent(todate) +
				'&currency=' + encodeURIComponent(currency) +
				'&dtltype=' + encodeURIComponent(dtltype) +
				'&type=' + encodeURIComponent(type) +
				'&version=' + encodeURIComponent(version);
			fetch(downloadUrl)  // ‚úÖ no invalid characters now
				.then(res => res.text())
				.then(jobId => {

					alertMsg.innerHTML = 'Download request received...' + jobId;
					showAlert();
					sessionStorage.setItem("jobId", jobId);
					sessionStorage.setItem("filename", filename);
					checkReport(jobId);
				});
		}

		function checkReport(jobId) {
			const alertMsg = document.getElementById("alertMessage");
			fetch('/BRRS/Reports/checkreport?jobId=' + encodeURIComponent(jobId))
				.then(res => res.text())
				.then(status => {
					if (status === "READY") {
						alertMsg.innerHTML = 'Report is ready! Downloaded';
						showAlert();
						const filename = sessionStorage.getItem("filename");
						downloadDetailfile(jobId, filename  + ".xlsx")
						sessionStorage.removeItem("jobId");
						sessionStorage.removeItem("filename");

					} else if (status === "PROCESSING") {
						alertMsg.innerHTML = 'Download Is Processing‚Ä¶';
						showAlert();
						setTimeout(() => checkReport(jobId), 5000);
					}
					else if (status === "ERROR") {
						alertMsg.innerHTML = 'No data was available to create a download.';
						showAlert();
						sessionStorage.removeItem("jobId");
						sessionStorage.removeItem("filename");
					}
				});
		}



		function downloadDetailfile(jobId, filename) {

			//$('#loader').modal('show');

			$.ajax({
				url: '/BRRS/Reports/downloaddetailExcel?jobId=' + jobId +
					'&filename=' + filename,
				type: 'GET',
				xhrFields: {
					responseType: 'blob'
				},
				success: function (data) {
					$('#loader').modal('hide');

					if (data && data.size > 100) {
						const blob = new Blob([data], {type: 'application/vnd.ms-excel'});
						const url = window.URL.createObjectURL(blob);
						const a = document.createElement('a');
						a.style.display = 'none';
						a.href = url;
						a.download = filename;
						document.body.appendChild(a);
						a.click();
						window.URL.revokeObjectURL(url);
						document.body.removeChild(a);

						showResultModal('BRRS', filename + ' downloaded successfully');
					} else {
						showResultModal('Information', 'No data was available to create a download.');
					}
				},
				error: function (jqXHR, textStatus, errorThrown) {
					$('#loader').modal('hide');
					console.error("Download failed:", textStatus, errorThrown);
					showResultModal('Error', 'An error occurred while downloading the file. Please try again.');
				}
			});
		}


	</script>

<script th:inline="javascript">
		function showdetailsbyRowAndColumn(a) {
			var reportlabel = a.getAttribute('reportlabel');
			var reportAddlCriteria1 = a.getAttribute('reportAddlCriteria1');
			var cellValue = a.textContent || a.innerText;

			if (cellValue !== '0') {
				// Set dynamic message in modal (instead of confirm)
				document.getElementById("cellresultModalLabel").innerText =
					"Do you want to open details for Row ID: " + reportlabel + " and Column ID: " + reportAddlCriteria1 + "?";

				// Show custom Bootstrap modal
				$('#cellresultModal').modal('show');

				// Handle Yes button
				document.querySelector('.yes-btn').onclick = function () {
					$('#cellresultModal').modal('hide');

					// Show loader
					const loader = bootstrap.Modal.getOrCreateInstance(document.getElementById('loader'), {
						backdrop: 'static',
						keyboard: false
					});
					$('#loader').modal('show');

					// Build dynamic URL
					var Callurl = /*[[@{'/Reports/' + ${reportid} + '/Details'(asondate=${asondate}, fromdate=${fromdate}, todate=${todate}, currency=${currency}, dtltype=${dtltype},type=${type},version=${version})}]]*/ "";
					Callurl += "&filter=" + encodeURIComponent(reportlabel + "," + reportAddlCriteria1);

					location.href = Callurl;
				};
			} else {
				// Use your custom alert modal instead of window.alert
				showResultModal("Alert", "No Records available for this selected cell.");
			}
		}
	</script>





<script>
function showmodify(btn) {
    // Enable editable fields
    $(".Show_input").not(".nonEditable").removeAttr("readonly").removeAttr("disabled");

    // ===== GROUP 1 =====
    let rows1 = [11, 12, 13, 14, 15, 16];
    let fields1 = ["ex_rate_buy", "ex_rate_sell", "notice_0to31", "notice_32to88", "cer_of_depo"];

    rows1.forEach(r => {
        fields1.forEach(f => {
            const selector = `#r${r}_${f}`;
            if ($(selector).length) $(selector).css("background-color", "#d3d3d3");
        });
    });

    // ===== GROUP 2 =====
    let rows2 = [18];
    let fields2 = ["notice_0to31", "notice_32to88", "cer_of_depo"];

    rows2.forEach(r => {
        fields2.forEach(f => {
            const selector = `#r${r}_${f}`;
            if ($(selector).length) $(selector).css("background-color", "#d3d3d3");
        });
    });

    // ===== GROUP 3 =====
    let rows3 = [28, 29, 30, 31, 32, 33];
    let fields3 = ["import", "investment", "other", "residents", "non_residents"];

    rows3.forEach(r => {
        fields3.forEach(f => {
            const selector = `#r${r}_${f}`;
            if ($(selector).length) $(selector).css("background-color", "#d3d3d3");
        });
    });

    // Show buttons
    $("#submitButton").show();
    $("#cancelRecord").show();

    // Hide the modify button clicked
    $(btn).hide();
}


//Cancel / Reset function
function cancelModify() {
    if (confirm("Are you sure you want to cancel changes? Page will reload.")) {
        // ‚úÖ Only when user clicks YES
        location.reload();
        
        $(".Show_input").attr("readonly", true).attr("disabled", true);

        $("#submitButton, #btnBack_edit").hide();
        $("#btnBack").show();

        // Hide Cancel button again
        $("#cancelRecord").hide();

        // Show all Modify buttons
        $("#addRecord").show();
    }
    // ‚ùå If user clicks CANCEL, nothing happens
}

</script>




<script>

 function calculateR17_0_31() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let R11Amt1 = parseFloat($("#r11_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R12Amt1 = parseFloat($("#r12_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R13Amt1 = parseFloat($("#r13_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R14Amt1 = parseFloat($("#r14_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R15Amt1 = parseFloat($("#r15_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R16Amt1 = parseFloat($("#r16_notice_0to31").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R14
	    let R17Amt = R11Amt1 + R12Amt1 + R13Amt1 + R14Amt1 + R15Amt1 + R16Amt1;

	    // Update R12Amt2 display
	    $("#r17_notice_0to31").text(R17Amt.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r11_notice_0to31").is("input")) $("#r11_notice_0to31").val(R11Amt1.toLocaleString('en-US'));
	    if ($("#r12_notice_0to31").is("input")) $("#r12_notice_0to31").val(R12Amt1.toLocaleString('en-US'));
	    if ($("#r13_notice_0to31").is("input")) $("#r13_notice_0to31").val(R13Amt1.toLocaleString('en-US'));
	    if ($("#r14_notice_0to31").is("input")) $("#r14_notice_0to31").val(R14Amt1.toLocaleString('en-US'));
	    if ($("#r15_notice_0to31").is("input")) $("#r15_notice_0to31").val(R15Amt1.toLocaleString('en-US'));
	    if ($("#r16_notice_0to31").is("input")) $("#r16_notice_0to31").val(R16Amt1.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculateR17_0_31();

	    // Attach input listeners to any editable fields
	    $("#r11_notice_0to31, #r12_notice_0to31, #r13_notice_0to31, #r14_notice_0to31,#r15_notice_0to31, #r16_notice_0to31").on("input", function() {
	    	calculateR17_0_31();
	        
	    });
	});

	
	function calculateR17_32_88() {
	    // Read values from rows 11‚Äì16
	    let R11Amt = parseFloat($("#r11_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R12Amt = parseFloat($("#r12_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R13Amt = parseFloat($("#r13_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R14Amt = parseFloat($("#r14_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R15Amt = parseFloat($("#r15_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R16Amt = parseFloat($("#r16_notice_32to88").val().replace(/,/g, "")) || 0;

	    // Sum them
	    let R17Amt = R11Amt + R12Amt + R13Amt + R14Amt + R15Amt + R16Amt;

	    // Update total (Row 17)
	    $("#r17_notice_32to88").text(R17Amt.toLocaleString('en-US'));

	    // Reformat inputs back with commas
	    if ($("#r11_notice_32to88").is("input")) $("#r11_notice_32to88").val(R11Amt.toLocaleString('en-US'));
	    if ($("#r12_notice_32to88").is("input")) $("#r12_notice_32to88").val(R12Amt.toLocaleString('en-US'));
	    if ($("#r13_notice_32to88").is("input")) $("#r13_notice_32to88").val(R13Amt.toLocaleString('en-US'));
	    if ($("#r14_notice_32to88").is("input")) $("#r14_notice_32to88").val(R14Amt.toLocaleString('en-US'));
	    if ($("#r15_notice_32to88").is("input")) $("#r15_notice_32to88").val(R15Amt.toLocaleString('en-US'));
	    if ($("#r16_notice_32to88").is("input")) $("#r16_notice_32to88").val(R16Amt.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculateR17_32_88();

	    // Listen for changes
	    $("#r11_notice_32to88, #r12_notice_32to88, #r13_notice_32to88, #r14_notice_32to88, #r15_notice_32to88, #r16_notice_32to88")
	        .on("input", function() {
	            calculateR17_32_88();
	        });
	});
	
	function calculateR17_cer_of_depo() {
	    // Read values from rows 11‚Äì16
	    let R11Amt = parseFloat($("#r11_cer_of_depo").val().replace(/,/g, "")) || 0;
	    let R12Amt = parseFloat($("#r12_cer_of_depo").val().replace(/,/g, "")) || 0;
	    let R13Amt = parseFloat($("#r13_cer_of_depo").val().replace(/,/g, "")) || 0;
	    let R14Amt = parseFloat($("#r14_cer_of_depo").val().replace(/,/g, "")) || 0;
	    let R15Amt = parseFloat($("#r15_cer_of_depo").val().replace(/,/g, "")) || 0;
	    let R16Amt = parseFloat($("#r16_cer_of_depo").val().replace(/,/g, "")) || 0;

	    // Sum values into Row 17
	    let R17Amt = R11Amt + R12Amt + R13Amt + R14Amt + R15Amt + R16Amt;

	    // Update Row 17 Total
	    $("#r17_cer_of_depo").text(R17Amt.toLocaleString('en-US'));

	    // Reformat inputs with commas
	    if ($("#r11_cer_of_depo").is("input")) $("#r11_cer_of_depo").val(R11Amt.toLocaleString('en-US'));
	    if ($("#r12_cer_of_depo").is("input")) $("#r12_cer_of_depo").val(R12Amt.toLocaleString('en-US'));
	    if ($("#r13_cer_of_depo").is("input")) $("#r13_cer_of_depo").val(R13Amt.toLocaleString('en-US'));
	    if ($("#r14_cer_of_depo").is("input")) $("#r14_cer_of_depo").val(R14Amt.toLocaleString('en-US'));
	    if ($("#r15_cer_of_depo").is("input")) $("#r15_cer_of_depo").val(R15Amt.toLocaleString('en-US'));
	    if ($("#r16_cer_of_depo").is("input")) $("#r16_cer_of_depo").val(R16Amt.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculateR17_cer_of_depo();

	    // Listen for changes in rows 11‚Äì16
	    $("#r11_cer_of_depo, #r12_cer_of_depo, #r13_cer_of_depo, #r14_cer_of_depo, #r15_cer_of_depo, #r16_cer_of_depo")
	        .on("input", function() {
	            calculateR17_cer_of_depo();
	        });
	});


	
	

	function calculateR11Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let R11c5 = parseFloat($("#r11_current").is("input") ? $("#r11_current").val().replace(/,/g, "") : $("#r11_current").text().replace(/,/g, "")) || 0;
	    let R11c6 = parseFloat($("#r11_call").is("input") ? $("#r11_call").val().replace(/,/g, "") : $("#r11_call").text().replace(/,/g, "")) || 0;
	    let R11c7 = parseFloat($("#r11_savings").is("input") ? $("#r11_savings").val().replace(/,/g, "") : $("#r11_savings").text().replace(/,/g, "")) || 0;
	    let R11c8 = parseFloat($("#r11_notice_0to31").val().replace(/,/g, "")) || 0;
	    let R11c9 = parseFloat($("#r11_notice_32to88").val().replace(/,/g, "")) || 0;
	    let R11c10 = parseFloat($("#r11_fix_depo_91_day_depo").is("input") ? $("#r11_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r11_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let R11c11 = parseFloat($("#r11_fix_depo_1to2").is("input") ? $("#r11_fix_depo_1to2").val().replace(/,/g, "") : $("#r11_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let R11c12 = parseFloat($("#r11_fix_depo_4to6").is("input") ? $("#r11_fix_depo_4to6").val().replace(/,/g, "") : $("#r11_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let R11c13 = parseFloat($("#r11_fix_depo_7to12").is("input") ? $("#r11_fix_depo_7to12").val().replace(/,/g, "") : $("#r11_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let R11c14 = parseFloat($("#r11_fix_depo_13to18").is("input") ? $("#r11_fix_depo_13to18").val().replace(/,/g, "") : $("#r11_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let R11c15 = parseFloat($("#r11_fix_depo_19to24").is("input") ? $("#r11_fix_depo_19to24").val().replace(/,/g, "") : $("#r11_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let R11c16 = parseFloat($("#r11_fix_depo_over24").is("input") ? $("#r11_fix_depo_over24").val().replace(/,/g, "") : $("#r11_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let R11c17 = parseFloat($("#r11_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let R11c18 = R11c5 + R11c6 + R11c7 + R11c8 + R11c9 + R11c10 + R11c11 + R11c12 + R11c13 + R11c14 + R11c15
	    + R11c16 + R11c17;

	    // Update R26Amt2 display
	    $("#r11_total").text(R11c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r11_current").is("input")) $("#r11_current").val(R11c5.toLocaleString('en-US'));
	    if ($("#r11_call").is("input")) $("#r11_call").val(R11c6.toLocaleString('en-US'));
	    if ($("#r11_savings").is("input")) $("#r11_savings").val(R11c7.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_91_day_depo").is("input")) $("#r11_fix_depo_91_day_depo").val(R11c10.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_1to2").is("input")) $("#r11_fix_depo_1to2").val(R11c11.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_4to6").is("input")) $("#r11_fix_depo_4to6").val(R11c12.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_7to12").is("input")) $("#r11_fix_depo_7to12").val(R11c13.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_13to18").is("input")) $("#r11_fix_depo_13to18").val(R11c14.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_19to24").is("input")) $("#r11_fix_depo_19to24").val(R11c15.toLocaleString('en-US'));
	    if ($("#r11_fix_depo_over24").is("input")) $("#r11_fix_depo_over24").val(R11c16.toLocaleString('en-US'));
	    if ($("#r11_notice_0to31").is("input")) $("#r11_notice_0to31").val(R11c8.toLocaleString('en-US'));
	    if ($("#r11_notice_32to88").is("input")) $("#r11_notice_32to88").val(R11c9.toLocaleString('en-US'));
	    if ($("#r11_cer_of_depo").is("input")) $("#r11_cer_of_depo").val(R11c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculateR11Totals();

	    // Attach input listeners to any editable fields
	    $("#r11_notice_0to31, #r11_notice_32to88, #r11_cer_of_depo").on("input", function() {
	        calculateR11Totals();
	        
	    });
	});
	function calculater12Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r12c5 = parseFloat($("#r12_current").is("input") ? $("#r12_current").val().replace(/,/g, "") : $("#r12_current").text().replace(/,/g, "")) || 0;
	    let r12c6 = parseFloat($("#r12_call").is("input") ? $("#r12_call").val().replace(/,/g, "") : $("#r12_call").text().replace(/,/g, "")) || 0;
	    let r12c7 = parseFloat($("#r12_savings").is("input") ? $("#r12_savings").val().replace(/,/g, "") : $("#r12_savings").text().replace(/,/g, "")) || 0;
	    let r12c8 = parseFloat($("#r12_notice_0to31").val().replace(/,/g, "")) || 0;
	    let r12c9 = parseFloat($("#r12_notice_32to88").val().replace(/,/g, "")) || 0;
	    let r12c10 = parseFloat($("#r12_fix_depo_91_day_depo").is("input") ? $("#r12_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r12_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r12c11 = parseFloat($("#r12_fix_depo_1to2").is("input") ? $("#r12_fix_depo_1to2").val().replace(/,/g, "") : $("#r12_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r12c12 = parseFloat($("#r12_fix_depo_4to6").is("input") ? $("#r12_fix_depo_4to6").val().replace(/,/g, "") : $("#r12_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r12c13 = parseFloat($("#r12_fix_depo_7to12").is("input") ? $("#r12_fix_depo_7to12").val().replace(/,/g, "") : $("#r12_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r12c14 = parseFloat($("#r12_fix_depo_13to18").is("input") ? $("#r12_fix_depo_13to18").val().replace(/,/g, "") : $("#r12_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r12c15 = parseFloat($("#r12_fix_depo_19to24").is("input") ? $("#r12_fix_depo_19to24").val().replace(/,/g, "") : $("#r12_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r12c16 = parseFloat($("#r12_fix_depo_over24").is("input") ? $("#r12_fix_depo_over24").val().replace(/,/g, "") : $("#r12_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let r12c17 = parseFloat($("#r12_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r12c18 = r12c5 + r12c6 + r12c7 + r12c8 + r12c9 + r12c10 + r12c11 + r12c12 + r12c13 + r12c14 + r12c15
	    + r12c16 + r12c17;

	    // Update R26Amt2 display
	    $("#r12_total").text(r12c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r12_current").is("input")) $("#r12_current").val(r12c5.toLocaleString('en-US'));
	    if ($("#r12_call").is("input")) $("#r12_call").val(r12c6.toLocaleString('en-US'));
	    if ($("#r12_savings").is("input")) $("#r12_savings").val(r12c7.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_91_day_depo").is("input")) $("#r12_fix_depo_91_day_depo").val(r12c10.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_1to2").is("input")) $("#r12_fix_depo_1to2").val(r12c11.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_4to6").is("input")) $("#r12_fix_depo_4to6").val(r12c12.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_7to12").is("input")) $("#r12_fix_depo_7to12").val(r12c13.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_13to18").is("input")) $("#r12_fix_depo_13to18").val(r12c14.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_19to24").is("input")) $("#r12_fix_depo_19to24").val(r12c15.toLocaleString('en-US'));
	    if ($("#r12_fix_depo_over24").is("input")) $("#r12_fix_depo_over24").val(r12c16.toLocaleString('en-US'));
	    if ($("#r12_notice_0to31").is("input")) $("#r12_notice_0to31").val(r12c8.toLocaleString('en-US'));
	    if ($("#r12_notice_32to88").is("input")) $("#r12_notice_32to88").val(r12c9.toLocaleString('en-US'));
	    if ($("#r12_cer_of_depo").is("input")) $("#r12_cer_of_depo").val(r12c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculater12Totals();

	    // Attach input listeners to any editable fields
	    $("#r12_notice_0to31, #r12_notice_32to88, #r12_cer_of_depo").on("input", function() {
	        calculater12Totals();
	        
	    });
	});
	function calculater13Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r13c5 = parseFloat($("#r13_current").is("input") ? $("#r13_current").val().replace(/,/g, "") : $("#r13_current").text().replace(/,/g, "")) || 0;
	    let r13c6 = parseFloat($("#r13_call").is("input") ? $("#r13_call").val().replace(/,/g, "") : $("#r13_call").text().replace(/,/g, "")) || 0;
	    let r13c7 = parseFloat($("#r13_savings").is("input") ? $("#r13_savings").val().replace(/,/g, "") : $("#r13_savings").text().replace(/,/g, "")) || 0;
	    let r13c8 = parseFloat($("#r13_notice_0to31").val().replace(/,/g, "")) || 0;
	    let r13c9 = parseFloat($("#r13_notice_32to88").val().replace(/,/g, "")) || 0;
	    let r13c10 = parseFloat($("#r13_fix_depo_91_day_depo").is("input") ? $("#r13_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r13_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r13c11 = parseFloat($("#r13_fix_depo_1to2").is("input") ? $("#r13_fix_depo_1to2").val().replace(/,/g, "") : $("#r13_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r13c12 = parseFloat($("#r13_fix_depo_4to6").is("input") ? $("#r13_fix_depo_4to6").val().replace(/,/g, "") : $("#r13_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r13c13 = parseFloat($("#r13_fix_depo_7to12").is("input") ? $("#r13_fix_depo_7to12").val().replace(/,/g, "") : $("#r13_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r13c14 = parseFloat($("#r13_fix_depo_13to18").is("input") ? $("#r13_fix_depo_13to18").val().replace(/,/g, "") : $("#r13_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r13c15 = parseFloat($("#r13_fix_depo_19to24").is("input") ? $("#r13_fix_depo_19to24").val().replace(/,/g, "") : $("#r13_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r13c16 = parseFloat($("#r13_fix_depo_over24").is("input") ? $("#r13_fix_depo_over24").val().replace(/,/g, "") : $("#r13_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let r13c17 = parseFloat($("#r13_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r13c18 = r13c5 + r13c6 + r13c7 + r13c8 + r13c9 + r13c10 + r13c11 + r13c12 + r13c13 + r13c14 + r13c15
	    + r13c16 + r13c17;

	    // Update R26Amt2 display
	    $("#r13_total").text(r13c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r13_current").is("input")) $("#r13_current").val(r13c5.toLocaleString('en-US'));
	    if ($("#r13_call").is("input")) $("#r13_call").val(r13c6.toLocaleString('en-US'));
	    if ($("#r13_savings").is("input")) $("#r13_savings").val(r13c7.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_91_day_depo").is("input")) $("#r13_fix_depo_91_day_depo").val(r13c10.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_1to2").is("input")) $("#r13_fix_depo_1to2").val(r13c11.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_4to6").is("input")) $("#r13_fix_depo_4to6").val(r13c12.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_7to12").is("input")) $("#r13_fix_depo_7to12").val(r13c13.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_13to18").is("input")) $("#r13_fix_depo_13to18").val(r13c14.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_19to24").is("input")) $("#r13_fix_depo_19to24").val(r13c15.toLocaleString('en-US'));
	    if ($("#r13_fix_depo_over24").is("input")) $("#r13_fix_depo_over24").val(r13c16.toLocaleString('en-US'));
	    if ($("#r13_notice_0to31").is("input")) $("#r13_notice_0to31").val(r13c8.toLocaleString('en-US'));
	    if ($("#r13_notice_32to88").is("input")) $("#r13_notice_32to88").val(r13c9.toLocaleString('en-US'));
	    if ($("#r13_cer_of_depo").is("input")) $("#r13_cer_of_depo").val(r13c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculater13Totals();

	    // Attach input listeners to any editable fields
	    $("#r13_notice_0to31, #r13_notice_32to88, #r13_cer_of_depo").on("input", function() {
	        calculater13Totals();
	        
	    });
	});
	function calculater14Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r14c5 = parseFloat($("#r14_current").is("input") ? $("#r14_current").val().replace(/,/g, "") : $("#r14_current").text().replace(/,/g, "")) || 0;
	    let r14c6 = parseFloat($("#r14_call").is("input") ? $("#r14_call").val().replace(/,/g, "") : $("#r14_call").text().replace(/,/g, "")) || 0;
	    let r14c7 = parseFloat($("#r14_savings").is("input") ? $("#r14_savings").val().replace(/,/g, "") : $("#r14_savings").text().replace(/,/g, "")) || 0;
	    let r14c8 = parseFloat($("#r14_notice_0to31").val().replace(/,/g, "")) || 0;
	    let r14c9 = parseFloat($("#r14_notice_32to88").val().replace(/,/g, "")) || 0;
	    let r14c10 = parseFloat($("#r14_fix_depo_91_day_depo").is("input") ? $("#r14_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r14_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r14c11 = parseFloat($("#r14_fix_depo_1to2").is("input") ? $("#r14_fix_depo_1to2").val().replace(/,/g, "") : $("#r14_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r14c12 = parseFloat($("#r14_fix_depo_4to6").is("input") ? $("#r14_fix_depo_4to6").val().replace(/,/g, "") : $("#r14_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r14c13 = parseFloat($("#r14_fix_depo_7to12").is("input") ? $("#r14_fix_depo_7to12").val().replace(/,/g, "") : $("#r14_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r14c14 = parseFloat($("#r14_fix_depo_13to18").is("input") ? $("#r14_fix_depo_13to18").val().replace(/,/g, "") : $("#r14_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r14c15 = parseFloat($("#r14_fix_depo_19to24").is("input") ? $("#r14_fix_depo_19to24").val().replace(/,/g, "") : $("#r14_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r14c16 = parseFloat($("#r14_fix_depo_over24").is("input") ? $("#r14_fix_depo_over24").val().replace(/,/g, "") : $("#r14_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let r14c17 = parseFloat($("#r14_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r14c18 = r14c5 + r14c6 + r14c7 + r14c8 + r14c9 + r14c10 + r14c11 + r14c12 + r14c13 + r14c14 + r14c15
	    + r14c16 + r14c17;

	    // Update R26Amt2 display
	    $("#r14_total").text(r14c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r14_current").is("input")) $("#r14_current").val(r14c5.toLocaleString('en-US'));
	    if ($("#r14_call").is("input")) $("#r14_call").val(r14c6.toLocaleString('en-US'));
	    if ($("#r14_savings").is("input")) $("#r14_savings").val(r14c7.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_91_day_depo").is("input")) $("#r14_fix_depo_91_day_depo").val(r14c10.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_1to2").is("input")) $("#r14_fix_depo_1to2").val(r14c11.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_4to6").is("input")) $("#r14_fix_depo_4to6").val(r14c12.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_7to12").is("input")) $("#r14_fix_depo_7to12").val(r14c13.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_13to18").is("input")) $("#r14_fix_depo_13to18").val(r14c14.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_19to24").is("input")) $("#r14_fix_depo_19to24").val(r14c15.toLocaleString('en-US'));
	    if ($("#r14_fix_depo_over24").is("input")) $("#r14_fix_depo_over24").val(r14c16.toLocaleString('en-US'));
	    if ($("#r14_notice_0to31").is("input")) $("#r14_notice_0to31").val(r14c8.toLocaleString('en-US'));
	    if ($("#r14_notice_32to88").is("input")) $("#r14_notice_32to88").val(r14c9.toLocaleString('en-US'));
	    if ($("#r14_cer_of_depo").is("input")) $("#r14_cer_of_depo").val(r14c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculater14Totals();

	    // Attach input listeners to any editable fields
	    $("#r14_notice_0to31, #r14_notice_32to88, #r14_cer_of_depo").on("input", function() {
	        calculater14Totals();
	        
	    });
	});
	function calculater15Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r15c5 = parseFloat($("#r15_current").is("input") ? $("#r15_current").val().replace(/,/g, "") : $("#r15_current").text().replace(/,/g, "")) || 0;
	    let r15c6 = parseFloat($("#r15_call").is("input") ? $("#r15_call").val().replace(/,/g, "") : $("#r15_call").text().replace(/,/g, "")) || 0;
	    let r15c7 = parseFloat($("#r15_savings").is("input") ? $("#r15_savings").val().replace(/,/g, "") : $("#r15_savings").text().replace(/,/g, "")) || 0;
	    let r15c8 = parseFloat($("#r15_notice_0to31").val().replace(/,/g, "")) || 0;
	    let r15c9 = parseFloat($("#r15_notice_32to88").val().replace(/,/g, "")) || 0;
	    let r15c10 = parseFloat($("#r15_fix_depo_91_day_depo").is("input") ? $("#r15_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r15_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r15c11 = parseFloat($("#r15_fix_depo_1to2").is("input") ? $("#r15_fix_depo_1to2").val().replace(/,/g, "") : $("#r15_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r15c12 = parseFloat($("#r15_fix_depo_4to6").is("input") ? $("#r15_fix_depo_4to6").val().replace(/,/g, "") : $("#r15_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r15c13 = parseFloat($("#r15_fix_depo_7to12").is("input") ? $("#r15_fix_depo_7to12").val().replace(/,/g, "") : $("#r15_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r15c14 = parseFloat($("#r15_fix_depo_13to18").is("input") ? $("#r15_fix_depo_13to18").val().replace(/,/g, "") : $("#r15_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r15c15 = parseFloat($("#r15_fix_depo_19to24").is("input") ? $("#r15_fix_depo_19to24").val().replace(/,/g, "") : $("#r15_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r15c16 = parseFloat($("#r15_fix_depo_over24").is("input") ? $("#r15_fix_depo_over24").val().replace(/,/g, "") : $("#r15_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let r15c17 = parseFloat($("#r15_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r15c18 = r15c5 + r15c6 + r15c7 + r15c8 + r15c9 + r15c10 + r15c11 + r15c12 + r15c13 + r15c14 + r15c15
	    + r15c16 + r15c17;

	    // Update R26Amt2 display
	    $("#r15_total").text(r15c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r15_current").is("input")) $("#r15_current").val(r15c5.toLocaleString('en-US'));
	    if ($("#r15_call").is("input")) $("#r15_call").val(r15c6.toLocaleString('en-US'));
	    if ($("#r15_savings").is("input")) $("#r15_savings").val(r15c7.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_91_day_depo").is("input")) $("#r15_fix_depo_91_day_depo").val(r15c10.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_1to2").is("input")) $("#r15_fix_depo_1to2").val(r15c11.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_4to6").is("input")) $("#r15_fix_depo_4to6").val(r15c12.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_7to12").is("input")) $("#r15_fix_depo_7to12").val(r15c13.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_13to18").is("input")) $("#r15_fix_depo_13to18").val(r15c14.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_19to24").is("input")) $("#r15_fix_depo_19to24").val(r15c15.toLocaleString('en-US'));
	    if ($("#r15_fix_depo_over24").is("input")) $("#r15_fix_depo_over24").val(r15c16.toLocaleString('en-US'));
	    if ($("#r15_notice_0to31").is("input")) $("#r15_notice_0to31").val(r15c8.toLocaleString('en-US'));
	    if ($("#r15_notice_32to88").is("input")) $("#r15_notice_32to88").val(r15c9.toLocaleString('en-US'));
	    if ($("#r15_cer_of_depo").is("input")) $("#r15_cer_of_depo").val(r15c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculater15Totals();

	    // Attach input listeners to any editable fields
	    $("#r15_notice_0to31, #r15_notice_32to88, #r15_cer_of_depo").on("input", function() {
	        calculater15Totals();
	        
	    });
	});
	function calculater16Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r16_total").is("input") ? $("#r16_total").val().replace(/,/g, "") : $("#r16_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r16c5 = parseFloat($("#r16_current").is("input") ? $("#r16_current").val().replace(/,/g, "") : $("#r16_current").text().replace(/,/g, "")) || 0;
	    let r16c6 = parseFloat($("#r16_call").is("input") ? $("#r16_call").val().replace(/,/g, "") : $("#r16_call").text().replace(/,/g, "")) || 0;
	    let r16c7 = parseFloat($("#r16_savings").is("input") ? $("#r16_savings").val().replace(/,/g, "") : $("#r16_savings").text().replace(/,/g, "")) || 0;
	    let r16c8 = parseFloat($("#r16_notice_0to31").val().replace(/,/g, "")) || 0;
	    let r16c9 = parseFloat($("#r16_notice_32to88").val().replace(/,/g, "")) || 0;
	    let r16c10 = parseFloat($("#r16_fix_depo_91_day_depo").is("input") ? $("#r16_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r16_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r16c11 = parseFloat($("#r16_fix_depo_1to2").is("input") ? $("#r16_fix_depo_1to2").val().replace(/,/g, "") : $("#r16_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r16c12 = parseFloat($("#r16_fix_depo_4to6").is("input") ? $("#r16_fix_depo_4to6").val().replace(/,/g, "") : $("#r16_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r16c13 = parseFloat($("#r16_fix_depo_7to12").is("input") ? $("#r16_fix_depo_7to12").val().replace(/,/g, "") : $("#r16_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r16c14 = parseFloat($("#r16_fix_depo_13to18").is("input") ? $("#r16_fix_depo_13to18").val().replace(/,/g, "") : $("#r16_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r16c15 = parseFloat($("#r16_fix_depo_19to24").is("input") ? $("#r16_fix_depo_19to24").val().replace(/,/g, "") : $("#r16_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r16c16 = parseFloat($("#r16_fix_depo_over24").is("input") ? $("#r16_fix_depo_over24").val().replace(/,/g, "") : $("#r16_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    let r16c17 = parseFloat($("#r16_cer_of_depo").val().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r16c18 = r16c5 + r16c6 + r16c7 + r16c8 + r16c9 + r16c10 + r16c11 + r16c12 + r16c13 + r16c14 + r16c15
	    + r16c16 + r16c17;

	    // Update R26Amt2 display
	    $("#r16_total").text(r16c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r16_current").is("input")) $("#r16_current").val(r16c5.toLocaleString('en-US'));
	    if ($("#r16_call").is("input")) $("#r16_call").val(r16c6.toLocaleString('en-US'));
	    if ($("#r16_savings").is("input")) $("#r16_savings").val(r16c7.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_91_day_depo").is("input")) $("#r16_fix_depo_91_day_depo").val(r16c10.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_1to2").is("input")) $("#r16_fix_depo_1to2").val(r16c11.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_4to6").is("input")) $("#r16_fix_depo_4to6").val(r16c12.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_7to12").is("input")) $("#r16_fix_depo_7to12").val(r16c13.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_13to18").is("input")) $("#r16_fix_depo_13to18").val(r16c14.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_19to24").is("input")) $("#r16_fix_depo_19to24").val(r16c15.toLocaleString('en-US'));
	    if ($("#r16_fix_depo_over24").is("input")) $("#r16_fix_depo_over24").val(r16c16.toLocaleString('en-US'));
	    if ($("#r16_notice_0to31").is("input")) $("#r16_notice_0to31").val(r16c8.toLocaleString('en-US'));
	    if ($("#r16_notice_32to88").is("input")) $("#r16_notice_32to88").val(r16c9.toLocaleString('en-US'));
	    if ($("#r16_cer_of_depo").is("input")) $("#r16_cer_of_depo").val(r16c17.toLocaleString('en-US'));
	}

	$(document).ready(function() {
	    calculater16Totals();

	    // Attach input listeners to any editable fields
	    $("#r16_notice_0to31, #r16_notice_32to88, #r16_cer_of_depo").on("input", function() {
	        calculater16Totals();
	        
	    });
	});
	function calculater17Totals() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r17_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r17_total").is("input") ? $("#r17_total").val().replace(/,/g, "") : $("#r17_total").text().replace(/,/g, "")) || 0;

	    let r17c5 = parseFloat($("#r17_current").is("input") ? $("#r17_current").val().replace(/,/g, "") : $("#r17_current").text().replace(/,/g, "")) || 0;
	    let r17c6 = parseFloat($("#r17_call").is("input") ? $("#r17_call").val().replace(/,/g, "") : $("#r17_call").text().replace(/,/g, "")) || 0;
	    let r17c7 = parseFloat($("#r17_savings").is("input") ? $("#r17_savings").val().replace(/,/g, "") : $("#r17_savings").text().replace(/,/g, "")) || 0;
	    let r17c8 = parseFloat($("#r17_notice_0to31").is("input") ? $("#r17_notice_0to31").val().replace(/,/g, "") : $("#r17_notice_0to31").text().replace(/,/g, "")) || 0;
	    let r17c9 = parseFloat($("#r17_notice_32to88").is("input") ? $("#r17_notice_32to88").val().replace(/,/g, "") : $("#r17_notice_32to88").text().replace(/,/g, "")) || 0;
	    let r17c10 = parseFloat($("#r17_fix_depo_91_day_depo").is("input") ? $("#r17_fix_depo_91_day_depo").val().replace(/,/g, "") : $("#r17_fix_depo_91_day_depo").text().replace(/,/g, "")) || 0;
	    let r17c11 = parseFloat($("#r17_fix_depo_1to2").is("input") ? $("#r17_fix_depo_1to2").val().replace(/,/g, "") : $("#r17_fix_depo_1to2").text().replace(/,/g, "")) || 0;
	    let r17c12 = parseFloat($("#r17_fix_depo_4to6").is("input") ? $("#r17_fix_depo_4to6").val().replace(/,/g, "") : $("#r17_fix_depo_4to6").text().replace(/,/g, "")) || 0;
	    let r17c13 = parseFloat($("#r17_fix_depo_7to12").is("input") ? $("#r17_fix_depo_7to12").val().replace(/,/g, "") : $("#r17_fix_depo_7to12").text().replace(/,/g, "")) || 0;
	    let r17c14 = parseFloat($("#r17_fix_depo_13to18").is("input") ? $("#r17_fix_depo_13to18").val().replace(/,/g, "") : $("#r17_fix_depo_13to18").text().replace(/,/g, "")) || 0;
	    let r17c15 = parseFloat($("#r17_fix_depo_19to24").is("input") ? $("#r17_fix_depo_19to24").val().replace(/,/g, "") : $("#r17_fix_depo_19to24").text().replace(/,/g, "")) || 0;
	    let r17c16 = parseFloat($("#r17_fix_depo_over24").is("input") ? $("#r17_fix_depo_over24").val().replace(/,/g, "") : $("#r17_fix_depo_over24").text().replace(/,/g, "")) || 0;
	    
	    let r17c17 = parseFloat($("#r17_cer_of_depo").is("input") ? $("#r17_cer_of_depo").val().replace(/,/g, "") : $("#r17_cer_of_depo").text().replace(/,/g, "")) || 0;
	    
	    // Calculate R26
	    let r17c18 = r17c5 + r17c6 + r17c7 + r17c8 + r17c9 + r17c10 + r17c11 + r17c12 + r17c13 + r17c14 + r17c15
	    + r17c16 + r17c17;

	    // Update R26Amt2 display
	    $("#r17_total").text(r17c18.toLocaleString('en-US'));

	    // Reformat inputs if needed
	    if ($("#r17_current").is("input")) $("#r17_current").val(r17c5.toLocaleString('en-US'));
	    if ($("#r17_call").is("input")) $("#r17_call").val(r17c6.toLocaleString('en-US'));
	    if ($("#r17_savings").is("input")) $("#r17_savings").val(r17c7.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_91_day_depo").is("input")) $("#r17_fix_depo_91_day_depo").val(r17c10.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_1to2").is("input")) $("#r17_fix_depo_1to2").val(r17c11.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_4to6").is("input")) $("#r17_fix_depo_4to6").val(r17c12.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_7to12").is("input")) $("#r17_fix_depo_7to12").val(r17c13.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_13to18").is("input")) $("#r17_fix_depo_13to18").val(r17c14.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_19to24").is("input")) $("#r17_fix_depo_19to24").val(r17c15.toLocaleString('en-US'));
	    if ($("#r17_fix_depo_over24").is("input")) $("#r17_fix_depo_over24").val(r17c16.toLocaleString('en-US'));
	    if ($("#r17_notice_0to31").is("input")) $("#r17_notice_0to31").val(r17c8.toLocaleString('en-US'));
	    if ($("#r17_notice_32to88").is("input")) $("#r17_notice_32to88").val(r17c9.toLocaleString('en-US'));
	    if ($("#r17_cer_of_depo").is("input")) $("#r17_cer_of_depo").val(r17c17.toLocaleString('en-US'));
	}

	$(document).ready(function () {
	    // Call your row 17 function
	    calculater17Totals();

	    // Listeners for rows 12 to 16 calling their correct total-functions
	    [11,12, 13, 14, 15, 16].forEach(r => {
	        $(`#r${r}_notice_0to31, #r${r}_notice_32to88, #r${r}_cer_of_depo`)
	            .on("input", function () {
	                window[`calculater17Totals`]();
	            });
	    });
	});


	function calculateExRateMid() {

	    // rows to calculate
	    const rows = [11, 12, 13, 14, 15, 16];

	    rows.forEach(r => {

	        let buy  = parseFloat($(`#r${r}_ex_rate_buy`).val().replace(/,/g, "")) || 0;
	        let sell = parseFloat($(`#r${r}_ex_rate_sell`).val().replace(/,/g, "")) || 0;

	        let mid = (buy + sell) / 2;

	        // Update MID field
	        //$(`#r${r}_ex_rate_mid`).val(mid.toLocaleString('en-US'));
	        
	        $(`#r${r}_ex_rate_mid`).val(
	        	    mid.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })
	        	);


	        // Reformat inputs
	        if ($(`#r${r}_ex_rate_buy`).is("input"))
	            $(`#r${r}_ex_rate_buy`).val(buy.toLocaleString('en-US'));

	        if ($(`#r${r}_ex_rate_sell`).is("input"))
	            $(`#r${r}_ex_rate_sell`).val(sell.toLocaleString('en-US'));

	    });
	}

	$(document).ready(function () {

	    // Run once on load
	    calculateExRateMid();

	    // Add listeners for rows 11‚Äì16
	    [11, 12, 13, 14, 15, 16].forEach(r => {
	        $(`#r${r}_ex_rate_buy, #r${r}_ex_rate_sell`)
	            .on("input", function () {
	                calculateExRateMid();
	            });
	    });

	});

	function calculateAveragePula() {

	    const rows = [11, 12, 13, 14, 15, 16];

	    rows.forEach(r => {

	        let total = parseFloat(
	            $(`#r${r}_total`).is("input")
	                ? $(`#r${r}_total`).val().replace(/,/g, "")
	                : $(`#r${r}_total`).text().replace(/,/g, "")
	        ) || 0;

	        let rateMid = parseFloat($(`#r${r}_ex_rate_mid`).val().replace(/,/g, "")) || 0;

	        // same logic as your original
	        let pulaEq = total * rateMid;

	        // Update display
	        $(`#r${r}_avg_pula_equivalent`).text(pulaEq.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 }));

	        // Reformat inputs with commas
	        if ($(`#r${r}_ex_rate_mid`).is("input"))
	            $(`#r${r}_ex_rate_mid`).val(rateMid.toLocaleString('en-US'));

	        if ($(`#r${r}_total`).is("input"))
	            $(`#r${r}_total`).val(total.toLocaleString('en-US'));

	    });
	}

	$(document).ready(function () {

	    calculateAveragePula();

	    // Listeners for rows 11‚Äì16
	    [11, 12, 13, 14, 15, 16].forEach(r => {
	        $(`#r${r}_ex_rate_buy,
	           #r${r}_ex_rate_mid,
	           #r${r}_ex_rate_sell,
	           #r${r}_notice_0to31,
	           #r${r}_notice_32to88,
	           #r${r}_cer_of_depo`)
	        .on("input", function () {
	            calculateAveragePula();
	        });
	    });

	});

	function calculateAveragePulaTotal() {
	    // Get numeric values depending on element type
	//    let E15 = parseFloat($("#r15_total").is("input") ? $("#r15_total").val().replace(/,/g, "") : $("#r15_total").text().replace(/,/g, "")) || 0;
	  //  let E16 = parseFloat($("#r16_total").val().replace(/,/g, "")) || 0;
	   // let E17 = parseFloat($("#r34_total").is("input") ? $("#r34_total").val().replace(/,/g, "") : $("#r34_total").text().replace(/,/g, "")) || 0;


	    let A = parseFloat($("#r11_avg_pula_equivalent").is("input") ? $("#r11_avg_pula_equivalent").val().replace(/,/g, "") : $("#r11_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    let B = parseFloat($("#r12_avg_pula_equivalent").is("input") ? $("#r12_avg_pula_equivalent").val().replace(/,/g, "") : $("#r12_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    let C = parseFloat($("#r13_avg_pula_equivalent").is("input") ? $("#r13_avg_pula_equivalent").val().replace(/,/g, "") : $("#r13_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    let D = parseFloat($("#r14_avg_pula_equivalent").is("input") ? $("#r14_avg_pula_equivalent").val().replace(/,/g, "") : $("#r14_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    let E = parseFloat($("#r15_avg_pula_equivalent").is("input") ? $("#r15_avg_pula_equivalent").val().replace(/,/g, "") : $("#r15_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    let F = parseFloat($("#r16_avg_pula_equivalent").is("input") ? $("#r16_avg_pula_equivalent").val().replace(/,/g, "") : $("#r16_avg_pula_equivalent").text().replace(/,/g, "")) || 0;
	    
	    
	    // Calculate r36
	    let H = A + B + C + D + E + F ;

	    // Update R36Amt2 display
	    $("#r17_avg_pula_equivalent").text(H.toLocaleString('en-US'));

	}

	$(document).ready(function () {

		calculateAveragePulaTotal();

	    // Listeners for rows 11‚Äì16
	    [11, 12, 13, 14, 15, 16].forEach(r => {
	        $(`#r${r}_ex_rate_buy,
	           #r${r}_ex_rate_mid,
	           #r${r}_ex_rate_sell,
	           #r${r}_notice_0to31,
	           #r${r}_notice_32to88,
	           #r${r}_cer_of_depo`)
	        .on("input", function () {
	        	calculateAveragePulaTotal();
	        });
	    });

	});
	
	function calculateR34All() {

	    const rows = [28, 29, 30, 31, 32, 33];

	    const columns = [
	        "import",
	        "investment",
	        "other",
	        "residents",
	        "non_residents"
	    ];

	    columns.forEach(col => {

	        let total = 0;

	        rows.forEach(r => {
	            let selector = `#r${r}_${col}`;
	            let val = 0;

	            if ($(selector).length) {
	                val = $(selector).is("input")
	                    ? parseFloat($(selector).val().replace(/,/g, "")) || 0
	                    : parseFloat($(selector).text().replace(/,/g, "")) || 0;
	            }

	            total += val;
	        });

	        // Update row 34 for this column
	        if ($(`#r34_${col}`).is("input"))
	            $(`#r34_${col}`).val(total.toLocaleString('en-US'));
	        else
	            $(`#r34_${col}`).text(total.toLocaleString('en-US'));
	    });
	}

	$(document).ready(function () {

	    calculateR34All();

	    // Add listeners to update on change
	    const rows = [28, 29, 30, 31, 32, 33];
	    const columns = [
	        "import",
	        "investment",
	        "other",
	        "residents",
	        "non_residents"
	    ];

	    rows.forEach(r => {
	        columns.forEach(col => {
	            $(`#r${r}_${col}`).on("input", function () {
	                calculateR34All();
	            });
	        });
	    });

	});
	
	
	
	
</script>
<script>
	

	// This function is for closing the modal after an action is complete.
	// It hides the result and loader modals and reloads the page.
	function closemodels() {
	    $("#resultModal").modal("hide");
	    $('#loader').modal('hide');

		// Reload the page after a short delay to ensure the modal animation completes smoothly.
		    setTimeout(function () {
		        location.reload();
		    }, 300);
	}

	
	function fileuploads(btn) {
	    const asondate = btn.getAttribute("data-todate");
	    const type = btn.getAttribute("data-type");

	    // Show loader
	    $('#loader').modal('show');

	    try {
	        // ‚úÖ Step 1: Calculate totals
				calculateAveragePulaTotal();
				calculateAveragePula();
				calculateExRateMid();
				calculater17Totals();
				calculater16Totals();
				calculater15Totals();
				calculater14Totals();
				calculater13Totals();
				calculater12Totals();
				calculateR11Totals();
				calculateR17_cer_of_depo();
				calculateR17_32_88();
				calculateR17_0_31();
				calculateR34All();

	        // ‚úÖ Step 2: Remove commas from all text inputs
	        $("#fileupload input[type='text']").each(function () {
	            $(this).val($(this).val().replace(/,/g, ''));
	        });

	        // ‚úÖ Step 3: Validate form
	        if (!$("#fileupload").valid()) {
	            $('#loader').modal('hide');
	            return;
	        }

	        // ‚úÖ Step 4: Build FormData
	        const formData = new FormData();
	        formData.append("asondate", asondate);
	        formData.append("type", type);

	        $('#fileupload').find(':input').each(function () {
	            const name = $(this).attr('name');
	            if (name) {
	                formData.append(name, $(this).val());
	            }
	        });

	        // ‚úÖ Step 5: AJAX submission
	        $.ajax({
	            url: './MDEP3updateAll',
	            type: 'POST',
	            data: formData,
	            processData: false,
	            contentType: false,
	            dataType: 'text',
	            success: function () {
	                $("#resultModalLabel").text("BRRS");
	                $("#resultModalBody").text(" Updated Successfully.");
	                $("#resultModal").modal("show");
	            },
	            error: function (jqXHR) {
	                console.error("Error response:", jqXHR.responseText);
	                $("#resultModalLabel").text("Error");
	                $("#resultModalBody").text("Update failed. Check console for details.");
	                $("#resultModal").modal("show");
	            },
	            complete: function () {
	                $('#loader').modal('hide');
	            }
	        });

	    } catch (error) {
	        console.error("Error in fileuploads function:", error);
	        $('#loader').modal('hide');
	        $("#resultModalLabel").text("Error");
	        $("#resultModalBody").text("Unexpected error occurred. Check console.");
	        $("#resultModal").modal("show");
	    }
	}
	</script>

<script th:inline="javascript">
			    /*<![CDATA[*/
			    const reportId = /*[[${reportid}]]*/ null;
			    /*]]>*/
			</script>

<script>
			function openDetail(elem, mode) {
				
				var type = elem.getAttribute('data-type');   

							        if (type === "ARCHIVAL") {
							            showResultModal('BRRS',"Archived Data cannot be modified");
							            return;
							        }	
				const acctNo = elem.getAttribute("data-acctNo");
				 const asondate = elem.getAttribute("data-asondate");
				location.href = `/BRRS/Reports/${reportId}/Detailspage?formmode=${mode}&acctNo=${acctNo}&asondate=${asondate}`;
			}
		</script>

<style>

/* Keep the header fixed and aligned */
.dataTables_scrollHeadInner, .dataTables_scrollBody table {
	width: 100% !important;
}

/* Prevent thead shrinking at zoom */
.dataTables_scrollHeadInner table {
	width: 100% !important;
	min-width: 100% !important;
}

#reportdetails {
	width: 100% !important;
	table-layout: fixed !important;
}

#reportdetails th, #reportdetails td {
	white-space: nowrap;
}

table.dataTable th.dt-type-numeric, table.dataTable th.dt-type-date,
	table.dataTable td.dt-type-numeric, table.dataTable td.dt-type-date {
	text-align: left !important;
}

/* Right-align header (6th column = ACCT BALANCE) */
table.dataTable th.dt-type-numeric:nth-child(6) {
	text-align: right !important;
}

/* Right-align data (6th column = ACCT BALANCE) */
#reportdetails td:nth-child(6), .dataTables_scrollHeadInner table th:nth-child(6)
	{
	text-align: right !important;
	padding-right: 10px !important;
}
</style>

<script th:inline="javascript">
							  $(document).ready(function () {
							    var table = $('#reportdetails').DataTable({
							      scrollY: "550px",
							      scrollX: true,
							      scrollCollapse: true,
							      autoWidth: false,
							      paging: true,
							      searching: true,
							      lengthChange: false,
							      ordering: true,
							      pageLength: 100,
							      fixedHeader: true, // ‚úÖ You can simply set it to true
								  // ‚úÖ Column width settings
								   columnDefs: [
								     { width: "60px", targets: 0 },   // Edit icon column
								     { width: "180px", targets: 1 }  ,  // S No column
									 { width: "250px", targets: 5 },
									 { width: "250px", targets: 7 }// S No column
								   ],

							      dom: '<"d-flex justify-content-between align-items-center mb-2"f p>t'
							    });

							    // ‚úÖ Fix alignment on resize / zoom
							    $(window).on('resize', function () {
							      table.columns.adjust().draw(false);
							    });

							    // ‚úÖ Fix initial misalignment if loaded at non-100% zoom
							    setTimeout(function () {
							      table.columns.adjust().draw(false);
							    }, 500);
							  });
							</script>

<script>
    function submitUpdate() {
        const formData = $('#DetailForm').serialize(); // Ensure correct form ID

        // ‚úÖ Store the previous page URL
        const previousUrl = document.referrer; // same as going back once in history

        // Show loader while processing
        $('#loader').modal('show');

        $.ajax({
            url: `/BRRS/Reports/${reportId}/update`,
            type: 'POST',
            data: formData,
            success: function (response) {
                $('#loader').modal('hide');

                // ‚úÖ Handle SUCCESS & NON-SUCCESS (Information)
                if (response && response.toLowerCase().includes('success')) {
                	showResultModal('BRRS', response);
                } else {
                	showResultModal('Information', response || 'No data updated.');
                }

                // Redirect after 1.5 sec
                setTimeout(() => {
                    if (previousUrl) {
                        window.location.href = previousUrl;
                    } else {
                        window.history.back(); // fallback
                    }
                }, 1500);
            },

            error: function (xhr, status, error) {
                $('#loader').modal('hide');
                console.error("Update error:", error);

                // ‚úÖ Handle ERROR
                showResultModal('Error', 'Failed to update record. Please try again.');

                // Redirect back after delay even on error
                setTimeout(() => {
                    if (previousUrl) {
                        window.location.href = previousUrl;
                    } else {
                        window.history.back();
                    }
                }, 1500);
            }
        });
    }
</script>

</head>



<title>M_DEP3</title>
<body>
 <div class="container-fluid" style="padding-left: 0px; padding-right: 0px;">
  <div class="row">

   <div th:insert="HeaderMenu :: header"></div>



   <div class="card">
    <div class="card-header"
     style="background-color: rgb(107, 122, 143); display: flex; align-items: center; justify-content: space-between;">
     <div class="header-bar" onclick="back();">
      <!-- ‚¨ÖÔ∏è Left circular arrow -->
      <div class="left-arrow-circle">
       <i class="fa fa-arrow-left"></i>
      </div>

      <!-- Title -->
      <h5 class="header-title">(39) MONTHLY SCHEDULE: M-DEP3: FOREIGN CURRENCY DEPOSITS</h5>

      <!-- üöå Bus display box -->
      <div class="boards">
       <p class="scrolling-text">BANK OF BOTSWANA - BANKING SUPERVISION DEPARTMENT</p>
      </div>
     </div>


     <div class="custom-tab-btn-group nav-buttons" style="display: flex; color: white; align-items: center;">
      <!-- üìÖ Date -->
      <span class="white-text" style="color: white !important; font-size: 17px; margin-right: 5px; margin-left: 10px;">Report
       Date: <span th:text="${#strings.replace(asondate, '/', '-')}"></span>
      </span>


      <!-- Summary / Details -->
      <button class="custom-tab-btn" th:if="${displaymode == 'Details'}" onclick="showsummary();">Summary</button>

      <button class="custom-tab-btn" th:if="${displaymode == 'summary'}" onclick="showdetails();">Details</button>

      <!-- Modify -->
      <button class="custom-tab-btn" onclick="showmodify(this);" title="Click to EDIT Records"
       th:if="${type != 'ARCHIVAL' and displaymode == 'summary'}"
       th:classappend="${session.PERMISSIONS == 'W'} AND ${dtltype == 'report'} ? addedit" id="addRecord">Modify</button>

      <!-- Cancel -->
      <button class="custom-tab-btn" style="display: none;" title="Cancel editing" id="cancelRecord"
       onclick="cancelModify();">Cancel</button>

      <!-- Download button - Summary -->
      <button type="button" class="custom-tab-btn" th:if="${displaymode == 'summary'}"
       th:attr="data-reportid=${reportid}, 
                     data-asondate=${asondate}, 
                     data-fromdate=${fromdate}, 
                     data-todate=${todate}, 
                     data-currency=${currency},  
                     data-dtltype=${dtltype}, 
                     data-filename='M_DEP3.xlsx',
                     data-type=${type},
                     data-version=${version}"
       onclick="downloadfile(this);">
       <i class="fa fa-download"></i>
      </button>

      <!-- Download button - Details -->
      <button type="button" class="custom-tab-btn" th:if="${displaymode == 'Details'}"
       th:attr="data-reportid=${reportid}, 
                     data-asondate=${asondate}, 
                     data-fromdate=${fromdate}, 
                     data-todate=${todate}, 
                     data-currency=${currency},  
                     data-dtltype=${dtltype}, 
                     data-filename='M_DEP3Detail',
                     data-type=${type},
                     data-version=${version}"
       onclick="startReport(this)">
       <i class="fa fa-download"></i>
      </button>

     </div>
    </div>

   </div>


   <div th:if="${displaymode == 'summary'}">
    <div class="row">
     <div class="col-sm-12">
      <form action="#" method="POST" id="fileupload">
       <!-- <h5 style = "font-weight:bold;color:black;">BANK OF BOTSWANA - BANKING SUPERVISION DEPARTMENT<br>(1) MONTHLY SCHEDULE M-SP: STATEMENT OF FINANCIAL POSITION AS AT<br>(P'000)<br> </h5> -->
       <div class="table-wrapper table-responsive scrollable-table-container"
        style="border-right: 1px solid #dee2e6; max-height: 90vh; overflow-y: auto;">
        <table class="sticky-header-table table table-bordered table-cell table-sm table-condensed" id="reports">
         <thead class="thead-light" style="position: sticky; top: 0; border: 2px solid black; z-index: 1;">
          <tr>
           <th rowspan="2">(39A) FOREIGN CURRENCY ACCOUNTS BY CURRENCY</th>
           <th style="text-align: right;" colspan="3">Exchange Rates</th>
           <th style="text-align: right;" rowspan="2">Current</th>
           <th style="text-align: right;" rowspan="2">Call</th>
           <th style="text-align: right;" rowspan="2">Savings</th>
           <th style="text-align: right;" colspan="2">Notice (Days)</th>
           <th style="text-align: right;" colspan="7">Fixed Deposits (Months)</th>
           <th style="text-align: right;" rowspan="2">Certificates of Deposit</th>
           <th style="text-align: right;" rowspan="2">Total</th>
           <th style="text-align: right;" rowspan="2">Pula Equivalent</th>
           <th style="text-align: right;" rowspan="2">Average pula Equivalent</th>
          </tr>
          <tr>
           <th style="text-align: right;">Buy</th>
           <th style="text-align: right;">Mid</th>
           <th style="text-align: right;">Sell</th>
           <th style="text-align: right;">0-31</th>
           <th style="text-align: right;">32-88</th>
           <th style="text-align: right;">91 Day</th>
           <th style="text-align: right;">1-2</th>
           <th style="text-align: right;">4-6</th>
           <th style="text-align: right;">7-12</th>
           <th style="text-align: right;">13-18</th>
           <th style="text-align: right;">19-24</th>
           <th style="text-align: right;">Over 24</th>
          </tr>
         </thead>
         <tbody style="font-family: Arial" th:each="reportsummary: ${reportsummary}">
          <tr>
           <td th:text="${reportsummary.r11_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r11_ex_rate_buy != null ? #numbers.formatDecimal(report.r11_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_ex_rate_buy" name="r11_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r11_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="R11"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r11_ex_rate_mid != null ? #numbers.formatDecimal(report.r11_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_ex_rate_mid" name="r11_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r11_ex_rate_sell != null ? #numbers.formatDecimal(report.r11_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_ex_rate_sell" name="r11_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r11_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r11_current" th:text="${#numbers.formatDecimal(reportsummary.r11_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_call" th:text="${#numbers.formatDecimal(reportsummary.r11_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_savings" th:text="${#numbers.formatDecimal(reportsummary.r11_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r11_notice_0to31 != null ? #numbers.formatDecimal(report.r11_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_notice_0to31" name="r11_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r11_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r11_notice_32to88 != null ? #numbers.formatDecimal(report.r11_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_notice_32to88" name="r11_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r11_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r11_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r11_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r11_cer_of_depo != null ? #numbers.formatDecimal(report.r11_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r11_cer_of_depo" name="r11_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r11_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r11_total" th:text="${#numbers.formatDecimal(reportsummary.r11_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r11_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r11_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R11', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r11_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r11_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="background-color: rgb(107, 122, 143); color: white; text-align: right; width: 200px;"
            th:attr="reportLabel='R11', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td th:text="${reportsummary.r12_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="r12" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r12_ex_rate_buy != null ? #numbers.formatDecimal(report.r12_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_ex_rate_buy" name="r12_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r12_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="r12"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r12_ex_rate_mid != null ? #numbers.formatDecimal(report.r12_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_ex_rate_mid" name="r12_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="r12" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r12_ex_rate_sell != null ? #numbers.formatDecimal(report.r12_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_ex_rate_sell" name="r12_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r12_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R12', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r12_current" th:text="${#numbers.formatDecimal(reportsummary.r12_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_call" th:text="${#numbers.formatDecimal(reportsummary.r12_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_savings" th:text="${#numbers.formatDecimal(reportsummary.r12_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r12" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r12_notice_0to31 != null ? #numbers.formatDecimal(report.r12_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_notice_0to31" name="r12_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r12_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R12', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="r12" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r12_notice_32to88 != null ? #numbers.formatDecimal(report.r12_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_notice_32to88" name="r12_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r12_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R12', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r12_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r12_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r12" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r12_cer_of_depo != null ? #numbers.formatDecimal(report.r12_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r12_cer_of_depo" name="r12_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r12_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R12', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r12_total" th:text="${#numbers.formatDecimal(reportsummary.r12_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r12_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r12_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R12', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r12_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r12_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"
            th:attr="reportLabel='R12', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td th:text="${reportsummary.r13_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="r13" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r13_ex_rate_buy != null ? #numbers.formatDecimal(report.r13_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_ex_rate_buy" name="r13_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r13_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="r13"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r13_ex_rate_mid != null ? #numbers.formatDecimal(report.r13_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_ex_rate_mid" name="r13_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="r13" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r13_ex_rate_sell != null ? #numbers.formatDecimal(report.r13_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_ex_rate_sell" name="r13_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r13_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R13', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r13_current" th:text="${#numbers.formatDecimal(reportsummary.r13_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_call" th:text="${#numbers.formatDecimal(reportsummary.r13_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_savings" th:text="${#numbers.formatDecimal(reportsummary.r13_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r13" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r13_notice_0to31 != null ? #numbers.formatDecimal(report.r13_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_notice_0to31" name="r13_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r13_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R13', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="r13" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r13_notice_32to88 != null ? #numbers.formatDecimal(report.r13_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_notice_32to88" name="r13_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r13_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R13', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r13_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r13_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r13" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r13_cer_of_depo != null ? #numbers.formatDecimal(report.r13_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r13_cer_of_depo" name="r13_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r13_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R13', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r13_total" th:text="${#numbers.formatDecimal(reportsummary.r13_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r13_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r13_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R13', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r13_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r13_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="background-color: rgb(107, 122, 143); color: white; text-align: right; width: 200px;"
            th:attr="reportLabel='R13', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td th:text="${reportsummary.r14_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="r14" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r14_ex_rate_buy != null ? #numbers.formatDecimal(report.r14_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_ex_rate_buy" name="r14_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r14_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="r14"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r14_ex_rate_mid != null ? #numbers.formatDecimal(report.r14_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_ex_rate_mid" name="r14_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="r14" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r14_ex_rate_sell != null ? #numbers.formatDecimal(report.r14_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_ex_rate_sell" name="r14_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r14_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R14', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r14_current" th:text="${#numbers.formatDecimal(reportsummary.r14_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_call" th:text="${#numbers.formatDecimal(reportsummary.r14_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_savings" th:text="${#numbers.formatDecimal(reportsummary.r14_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r14" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r14_notice_0to31 != null ? #numbers.formatDecimal(report.r14_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_notice_0to31" name="r14_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r14_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R14', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="r14" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r14_notice_32to88 != null ? #numbers.formatDecimal(report.r14_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_notice_32to88" name="r14_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r14_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R14', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r14_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r14_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r14" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r14_cer_of_depo != null ? #numbers.formatDecimal(report.r14_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r14_cer_of_depo" name="r14_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r14_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R14', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r14_total" th:text="${#numbers.formatDecimal(reportsummary.r14_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r14_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r14_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R14', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r14_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r14_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white; width: 200px;"
            th:attr="reportLabel='R14', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td th:text="${reportsummary.r15_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="r15" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r15_ex_rate_buy != null ? #numbers.formatDecimal(report.r15_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_ex_rate_buy" name="r15_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r15_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="r15"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r15_ex_rate_mid != null ? #numbers.formatDecimal(report.r15_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_ex_rate_mid" name="r15_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="r15" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r15_ex_rate_sell != null ? #numbers.formatDecimal(report.r15_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_ex_rate_sell" name="r15_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r15_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R15', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r15_current" th:text="${#numbers.formatDecimal(reportsummary.r15_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_call" th:text="${#numbers.formatDecimal(reportsummary.r15_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_savings" th:text="${#numbers.formatDecimal(reportsummary.r15_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r15" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r15_notice_0to31 != null ? #numbers.formatDecimal(report.r15_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_notice_0to31" name="r15_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r15_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R15', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="r15" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r15_notice_32to88 != null ? #numbers.formatDecimal(report.r15_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_notice_32to88" name="r15_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r15_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R15', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r15_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r15_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r15" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r15_cer_of_depo != null ? #numbers.formatDecimal(report.r15_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r15_cer_of_depo" name="r15_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r15_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R15', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r15_total" th:text="${#numbers.formatDecimal(reportsummary.r15_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r15_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r15_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R15', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r15_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r15_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white; width: 200px;"
            th:attr="reportLabel='R15', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td th:text="${reportsummary.r16_foreign_curr_acc_by_curr}" style="text-align: left; width: 200px;"></td>
           <td th:each="report: ${reportsummary1}" id="r16" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r16_ex_rate_buy != null ? #numbers.formatDecimal(report.r16_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_ex_rate_buy" name="r16_ex_rate_buy"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>

           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r16_ex_rate_mid,1,'COMMA',0,'POINT')}" style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C3'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="r16"
            style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143); color: white;">
            <input class="display-input Show_input nonEditable" type="text"
            th:value="${report.r16_ex_rate_mid != null ? #numbers.formatDecimal(report.r16_ex_rate_mid, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_ex_rate_mid" name="r16_ex_rate_mid"
            style="background-color: rgb(107, 122, 143); color: white; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <td th:each="report: ${reportsummary1}" id="r16" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r16_ex_rate_sell != null ? #numbers.formatDecimal(report.r16_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_ex_rate_sell" name="r16_ex_rate_sell"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!--  <td  th:text="${#numbers.formatDecimal(reportsummary.r16_ex_rate_sell,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R16', reportAddlCriteria1='C4'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r16_current" th:text="${#numbers.formatDecimal(reportsummary.r16_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C5'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_call" th:text="${#numbers.formatDecimal(reportsummary.r16_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C6'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_savings" th:text="${#numbers.formatDecimal(reportsummary.r16_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C7'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r16" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r16_notice_0to31 != null ? #numbers.formatDecimal(report.r16_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_notice_0to31" name="r16_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r16_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R16', reportAddlCriteria1='C8'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td th:each="report: ${reportsummary1}" id="r16" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r16_notice_32to88 != null ? #numbers.formatDecimal(report.r16_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_notice_32to88" name="r16_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r16_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R16', reportAddlCriteria1='C9'"
													onclick="showdetailsbyRowAndColumn(this)"></td> -->
           <td id="r16_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C10'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C11'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C12'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C13'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C14'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C15'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r16_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C16'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td th:each="report: ${reportsummary1}" id="r16" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r16_cer_of_depo != null ? #numbers.formatDecimal(report.r16_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r16_cer_of_depo" name="r16_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; margin-left: 10px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r16_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R16', reportAddlCriteria1='C17'"
													onclick="showdetailsbyRowAndColumn(this)" ></td> -->
           <td id="r16_total" th:text="${#numbers.formatDecimal(reportsummary.r16_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"></td>
           <td id="r16_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r16_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px;" th:attr="reportLabel='R16', reportAddlCriteria1='C19'"
            onclick="showdetailsbyRowAndColumn(this)"></td>
           <td id="r16_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r16_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; width: 200px; background-color: rgb(107, 122, 143); color: white;"
            th:attr="reportLabel='R16', reportAddlCriteria1='C20'"></td>
          </tr>
          <tr>
           <td id="r17_foreign_curr_acc_by_curr" th:text="${reportsummary.r17_foreign_curr_acc_by_curr}"
            style="text-align: left;"></td>

           <td id="r17_ex_rate_buy"
            th:text="${#numbers.formatDecimal(reportsummary.r17_ex_rate_buy,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R17', reportAddlCriteria1='C2'"
            ></td>

           <td id="r17_ex_rate_mid"
            th:text="${#numbers.formatDecimal(reportsummary.r17_ex_rate_mid,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R17', reportAddlCriteria1='C3'"
            ></td>

           <td id="r17_ex_rate_sell"
            th:text="${#numbers.formatDecimal(reportsummary.r17_ex_rate_sell,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R17', reportAddlCriteria1='C4'"
            ></td>

           <td id="r17_current" th:text="${#numbers.formatDecimal(reportsummary.r17_current,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_call" th:text="${#numbers.formatDecimal(reportsummary.r17_call,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_savings" th:text="${#numbers.formatDecimal(reportsummary.r17_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_notice_0to31"
            th:text="${#numbers.formatDecimal(reportsummary.r17_notice_0to31,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_notice_32to88"
            th:text="${#numbers.formatDecimal(reportsummary.r17_notice_32to88,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_91_day_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_1to2"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_4to6"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_7to12"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_13to18"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_19to24"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_fix_depo_over24"
            th:text="${#numbers.formatDecimal(reportsummary.r17_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_cer_of_depo"
            th:text="${#numbers.formatDecimal(reportsummary.r17_cer_of_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_total" th:text="${#numbers.formatDecimal(reportsummary.r17_total,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white; font-weight: bold;"></td>

           <td id="r17_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r17_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

           <td id="r17_avg_pula_equivalent"
            th:text="${#numbers.formatDecimal(reportsummary.r17_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right; background-color: rgb(107, 122, 143); color: white;"></td>

          </tr>

          <tr>
           <td th:text="${reportsummary.r18_foreign_curr_acc_by_curr}" style="text-align: left;"></td>
           <!--   <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left:10px; ">
    	<input
			class="display-input Show_input " type="text"
			th:value="${report.r18_ex_rate_buy != null ? #numbers.formatDecimal(report.r18_ex_rate_buy, 1, 'COMMA', 0, 'POINT') : '0'}"
			id="r18_ex_rate_buy" name="r18_ex_rate_buy"
			style="background-color: #FFFFFF; width: 180px; height: 28px; border-color: transparent; text-align: right; "
		readonly /></td> -->
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_ex_rate_buy,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C2'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_ex_rate_mid,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C3'"
            ></td>
           <!-- <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left:10px; ">
    	<input
			class="display-input Show_input " type="text"
			th:value="${report.r18_ex_rate_sell != null ? #numbers.formatDecimal(report.r18_ex_rate_sell, 1, 'COMMA', 0, 'POINT') : '0'}"
			id="r18_ex_rate_sell" name="r18_ex_rate_sell"
			style="background-color: #FFFFFF; width: 180px; height: 28px; border-color: transparent; text-align: right; "
		readonly /></td> -->
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_ex_rate_sell,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C4'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_current,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C5'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_call,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C6'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_savings,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C7'"
            ></td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r18_notice_0to31 != null ? #numbers.formatDecimal(report.r18_notice_0to31, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r18_notice_0to31" name="r18_notice_0to31"
            style="background-color: #FFFFFF; width: 180px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r18_notice_0to31,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C8'"
													></td> -->
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r18_notice_32to88 != null ? #numbers.formatDecimal(report.r18_notice_32to88, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r18_notice_32to88" name="r18_notice_32to88"
            style="background-color: #FFFFFF; width: 180px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r18_notice_32to88,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C9'"
													></td> -->
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_91_day_depo,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C10'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_1to2,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C11'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_4to6,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C12'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_7to12,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C13'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_13to18,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C14'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_19to24,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C15'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_fix_depo_over24,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C16'"
            ></td>
           <td th:each="report: ${reportsummary1}" id="R11" style="text-align: right; width: 200px; padding-left: 10px;">
            <input class="display-input Show_input " type="text"
            th:value="${report.r18_cer_of_depo != null ? #numbers.formatDecimal(report.r18_cer_of_depo, 1, 'COMMA', 0, 'POINT') : '0'}"
            id="r18_cer_of_depo" name="r18_cer_of_depo"
            style="background-color: #FFFFFF; width: 180px; height: 28px; border-color: transparent; text-align: right;"
            readonly />
           </td>
           <!-- <td  th:text="${#numbers.formatDecimal(reportsummary.r18_cer_of_depo,1,'COMMA',0,'POINT')}" style="text-align: right;" th:attr="reportLabel='R11', reportAddlCriteria1='C17'"
													 ></td> -->
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_total,1,'COMMA',0,'POINT')}"
            style="text-align: right;"></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C19'"
            ></td>
           <td th:text="${#numbers.formatDecimal(reportsummary.r18_avg_pula_equivalent,1,'COMMA',0,'POINT')}"
            style="text-align: right;" th:attr="reportLabel='R18', reportAddlCriteria1='C20'"
            ></td>
          </tr>
         </tbody>
        </table>

        <div style="height: 60px;"></div>

        <div style="display: flex; justify-content: flex-start; align-items: center; gap: 800px; margin-bottom: 10px;">

         <h5 style="font-weight: bold; color: black; margin: 0;">
          (39 B) PURPOSE OF FOREIGN CURRENCY ACCOUNTS <br>(P'000)
         </h5>

         <h5 style="font-weight: bold; color: black; margin: 0;">
          (39C) HOLDERS OF FOREIGN CURRENCY ACCOUNTS ‚Äì RESIDENT/<br>NON-RESIDENT<br>(P'000)
         </h5>

        </div>


        <div class="table-wrapper table-responsive scrollable-table-container"
         style="border-right: 1px solid #dee2e6; max-height: 90vh; overflow-y: auto;">
         <table class="sticky-header-table table table-bordered table-cell table-sm table-condensed" id="reports">
          <thead class="thead-light"
           style="position: sticky; top: 0; border: none !important; background-color: #b3b6b9; z-index: 1;">
           <tr>
            <th></th>
            <th style="font-weight: bold; text-align: right;">Import</th>
            <th style="font-weight: bold; text-align: right;">Investment</th>
            <th style="font-weight: bold; text-align: right;">Other</th>

            <th class="noborder" colspan="4" style="border: none !important; background: transparent; width: 200px;"></th>


            <th></th>
            <th style="font-weight: bold; text-align: right;">Residents</th>
            <th style="font-weight: bold; text-align: right;">Non-residents</th>
           </tr>
          </thead>

          <tbody style="font-family: Arial" th:each="report : ${reportsummary1}">

           <!-- ===== R28 ===== -->
           <tr>
            <td>USD</td>

            <!-- 39B -->
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r28_import != null ? #numbers.formatDecimal(report.r28_import,1,'COMMA',0,'POINT') : '0'}"
             id="r28_import" name="r28_import"
             style="background: #fff; width: 180px; margin-left: 10px; height: 28px; border: transparent; text-align: right;"
             readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r28_investment != null ? #numbers.formatDecimal(report.r28_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r28_investment" name="r28_investment"
             style="background: #fff; width: 180px; margin-left: 10px; height: 28px; border: transparent; text-align: right;"
             readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r28_other != null ? #numbers.formatDecimal(report.r28_other,1,'COMMA',0,'POINT') : '0'}"
             id="r28_other" name="r28_other"
             style="background: #fff; width: 180px; margin-left: 10px; height: 28px; border: transparent; text-align: right;"
             readonly /></td>

            <!-- spacer -->
            <!--   <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->
            <td rowspan="7" colspan="4" style="width: 200px; border: none !important;"></td>

            <!-- 39C -->
            <td>USD</td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r28_residents != null ? #numbers.formatDecimal(report.r28_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r28_residents" name="r28_residents"
             style="background: #fff; width: 180px; margin-left: 10px; height: 28px; border: transparent; text-align: right;"
             readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r28_non_residents != null ? #numbers.formatDecimal(report.r28_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r28_non_residents" name="r28_non_residents"
             style="background: #fff; width: 180px; margin-left: 10px; height: 28px; border: transparent; text-align: right;"
             readonly /></td>
           </tr>

           <!-- ===== R29 ===== -->
           <tr>
            <td>ZAR</td>

            <!-- 39B -->
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r29_import != null ? #numbers.formatDecimal(report.r29_import,1,'COMMA',0,'POINT') : '0'}"
             id="r29_import" name="r29_import"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly />
            </td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r29_investment != null ? #numbers.formatDecimal(report.r29_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r29_investment" name="r29_investment"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly />
            </td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r29_other != null ? #numbers.formatDecimal(report.r29_other,1,'COMMA',0,'POINT') : '0'}"
             id="r29_other" name="r29_other"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly />
            </td>

            <!-- spacer -->
            <!--   <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->

            <!-- 39C -->
            <td>ZAR</td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r29_residents != null ? #numbers.formatDecimal(report.r29_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r29_residents" name="r29_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly />
            </td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r29_non_residents != null ? #numbers.formatDecimal(report.r29_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r29_non_residents" name="r29_non_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly />
            </td>
           </tr>

           <!-- ===== R30‚ÄìR33 (same pattern) ===== -->
           <!-- I keep full structure exactly as your code -->

           <tr>
            <td>GBP</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r30_import != null ? #numbers.formatDecimal(report.r30_import,1,'COMMA',0,'POINT') : '0'}"
             id="r30_import" name="r30_import"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r30_investment != null ? #numbers.formatDecimal(report.r30_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r30_investment" name="r30_investment"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r30_other != null ? #numbers.formatDecimal(report.r30_other,1,'COMMA',0,'POINT') : '0'}"
             id="r30_other" name="r30_other"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <!--   <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->

            <td>GBP</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r30_residents != null ? #numbers.formatDecimal(report.r30_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r30_residents" name="r30_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r30_non_residents != null ? #numbers.formatDecimal(report.r30_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r30_non_residents" name="r30_non_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>
           </tr>

           <!-- Repeat same block for r31, r32, r33 -->
           <tr>
            <td>EURO</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r31_import != null ? #numbers.formatDecimal(report.r31_import,1,'COMMA',0,'POINT') : '0'}"
             id="r31_import" name="r31_import"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r31_investment != null ? #numbers.formatDecimal(report.r31_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r31_investment" name="r31_investment"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r31_other != null ? #numbers.formatDecimal(report.r31_other,1,'COMMA',0,'POINT') : '0'}"
             id="r31_other" name="r31_other"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <!--   <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->

            <td>EURO</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r31_residents != null ? #numbers.formatDecimal(report.r31_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r31_residents" name="r31_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r31_non_residents != null ? #numbers.formatDecimal(report.r31_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r31_non_residents" name="r31_non_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>
           </tr>

           <tr>
            <td>Other*</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r32_import != null ? #numbers.formatDecimal(report.r32_import,1,'COMMA',0,'POINT') : '0'}"
             id="r32_import" name="r32_import"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r32_investment != null ? #numbers.formatDecimal(report.r32_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r32_investment" name="r32_investment"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r32_other != null ? #numbers.formatDecimal(report.r32_other,1,'COMMA',0,'POINT') : '0'}"
             id="r32_other" name="r32_other"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <!--   <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->

            <td>Other*</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r32_residents != null ? #numbers.formatDecimal(report.r32_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r32_residents" name="r32_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r32_non_residents != null ? #numbers.formatDecimal(report.r32_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r32_non_residents" name="r32_non_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>
           </tr>

           <tr>
            <td>Other*</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r33_import != null ? #numbers.formatDecimal(report.r33_import,1,'COMMA',0,'POINT') : '0'}"
             id="r33_import" name="r33_import"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r33_investment != null ? #numbers.formatDecimal(report.r33_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r33_investment" name="r33_investment"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r33_other != null ? #numbers.formatDecimal(report.r33_other,1,'COMMA',0,'POINT') : '0'}"
             id="r33_other" name="r33_other"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <!--     <td class="noborder" colspan="4"></td> -->


            <td>Other*</td>
            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r33_residents != null ? #numbers.formatDecimal(report.r33_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r33_residents" name="r33_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>

            <td style="text-align: right; width: 200px; padding-left: 10px;"><input
             class="display-input Show_input" type="text"
             th:value="${report.r33_non_residents != null ? #numbers.formatDecimal(report.r33_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r33_non_residents" name="r33_non_residents"
             style="background: #fff; width: 180px; height: 28px; border: transparent; text-align: right;" readonly /></td>
           </tr>
           <!-- ===== R34 (final row) ===== -->
           <tr>
            <td>Total</td>


            <td style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143);">
             <input class="display-input Show_input nonEditable" type="text"
             th:value="${report.r34_import != null ? #numbers.formatDecimal(report.r34_import,1,'COMMA',0,'POINT') : '0'}"
             id="r34_import" name="r34_import"
             style="background-color: rgb(107, 122, 143); color: white; width: 180px; height: 28px; border: transparent; text-align: right;"
             readonly />
            </td>
            <td style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143);">
             <input class="display-input Show_input nonEditable" type="text"
             th:value="${report.r34_investment != null ? #numbers.formatDecimal(report.r34_investment,1,'COMMA',0,'POINT') : '0'}"
             id="r34_investment" name="r34_investment"
             style="background-color: rgb(107, 122, 143); color: white; width: 180px; height: 28px; border: transparent; text-align: right;"
             readonly />
            </td>
            <td style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143);">
             <input class="display-input Show_input nonEditable" type="text"
             th:value="${report.r34_other != null ? #numbers.formatDecimal(report.r34_other,1,'COMMA',0,'POINT') : '0'}"
             id="r34_other" name="r34_other"
             style="background-color: rgb(107, 122, 143); color: white; width: 180px; height: 28px; border: transparent; text-align: right;"
             readonly />
            </td>



            <!--  <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td>
            <td style="border:none;"></td> -->

            <td>Total</td>

            <td style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143);">
             <input class="display-input Show_input" type="text"
             th:value="${report.r34_residents != null ? #numbers.formatDecimal(report.r34_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r34_residents" name="r34_residents"
             style="background-color: rgb(107, 122, 143); color: white; width: 200px; height: 28px; border: transparent; text-align: right;"
             readonly />
            </td>

            <td style="text-align: right; width: 200px; padding-left: 10px; background-color: rgb(107, 122, 143);">
             <input class="display-input Show_input" type="text"
             th:value="${report.r34_non_residents != null ? #numbers.formatDecimal(report.r34_non_residents,1,'COMMA',0,'POINT') : '0'}"
             id="r34_non_residents" name="r34_non_residents"
             style="background-color: rgb(107, 122, 143); color: white; width: 200px; height: 28px; border: transparent; text-align: right;"
             readonly />
            </td>
           </tr>

          </tbody>
         </table>


        </div>



       </div>
       <div style="text-align: center; background-color: white; padding: 15px;">

        <button id="submitButton" type="button" class="custom-tab-btn Show_input" form="fileupload"
         th:attr="data-todate=${asondate}" onclick="fileuploads(this);" style="display: none;">Submit</button>
       </div>
      </form>
     </div>
    </div>
   </div>
  </div>



  <!-- ------------------- -->
  <!--  DETAIL -->
  <div th:if="${displaymode == 'Details'}">
   <div class="row">
    <div class="col-sm-12" style="max-height: 90vh;">
     <div class="table-container" style="border-right: 1px solid #dee2e6;">
      <table class="table table-striped table-bordered table-hover" id="reportdetails">
       <thead class="thead-light">

        <tr>
         <th></th>
         <th>S No</th>
         <th>CUST ID</th>
         <th>ACCT NUMBER</th>
         <th>ACCT NAME</th>
         <th>ACCT BALANCE IN PULA</th>

         <th style="text-align: left;">REPORT LABEL</th>
         <th>REPORT ADDL CRITERIA 1</th>
         <th>REPORT DATE</th>
        </tr>

       </thead>

       <tbody style="font-family: Arial;">
        <tr th:each="report, srlno : ${reportdetails}">
         <td><a data-toggle="tooltip" class="editrec" title="Click to Edit this Record"> <i class="fas fa-edit"
           style="color: black; cursor: pointer;"
           th:attr="data-acctNo=${report.acctNumber},
																						data-asondate=${#dates.format(report.reportDate, 'dd-MM-yyyy')},data-type=${type}"
           onclick="openDetail(this, 'edit')"></i>

         </a></td>
         <td th:text="${srlno.index + 1}"></td>
         <td th:text="${report.custId != null ? report.custId : '-'}"></td>
         <td th:text="${report.acctNumber != null ? report.acctNumber : '-'}"></td>
         <td th:text="${report.acctName != null ? report.acctName : '-'}"></td>

         <td style="text-align: right;"
          th:text="${#numbers.formatDecimal(report.acctBalanceInpula,1,'COMMA',0,'POINT')}"></td>

         <td style="text-align: left;" th:text="${report.reportLabel != null ? report.reportLabel : '-'}"></td>
         <td th:text="${report.reportAddlCriteria1 != null ? report.reportAddlCriteria1 : '-'}"></td>
         <td th:text="${report.reportDate != null ? #dates.format(report.reportDate, 'dd-MM-yyyy') : '-'}"></td>
        </tr>
       </tbody>
      </table>

     </div>

     <!-- Submit Button -->
     <div style="text-align: center; margin-top: 15px; background-color: white;">
      <button id="submitButton" type="button" class="custom-tab-btn Show_input" onclick="updateform();"
       style="display: none;">Submit</button>
     </div>
    </div>
   </div>

  </div>

  <!-- M_DEP3 Detail Form Screen -->
  <div th:if="${formmode == 'edit'}" class="card">
   <div class="card-body">
    <form th:object="${Data}" method="post" id="DetailForm">

     <!-- Row 1 -->
     <div class="row formline" style="margin-top: 10px;">
      <label class="col-sm-2">Customer ID</label>
      <div class="col-sm-3">
       <input type="text" th:field="*{custId}" class="form-control form-control-sm" readonly />
      </div>

      <div class="col-sm-1"></div>

      <label class="col-sm-2">Account Number</label>
      <div class="col-sm-3">
       <input type="text" th:field="*{acctNumber}" class="form-control form-control-sm" readonly />
      </div>
     </div>

     <!-- Row 2 -->
     <div class="row formline" style="margin-top: 10px;">
      <label class="col-sm-2">Account Name</label>
      <div class="col-sm-3">
       <input type="text" th:field="*{acctName}" class="form-control form-control-sm" readonly />
      </div>

      <div class="col-sm-1"></div>

      <label class="col-sm-2">Acct Balance</label>
      <div class="col-sm-3">
       <input type="number" step="0.01" th:field="*{acctBalanceInpula}" class="form-control form-control-sm"
        style="text-align: right;" />
      </div>
     </div>

     <!-- Row 3 -->
     <div class="row formline" style="margin-top: 10px;">
      <label class="col-sm-2">Report Label</label>
      <div class="col-sm-3">
       <input type="text" th:field="*{reportLabel}" class="form-control form-control-sm" readonly />
      </div>

      <div class="col-sm-1"></div>

      <label class="col-sm-2">Report Addl Criteria 1</label>
      <div class="col-sm-3">
       <input type="text" th:field="*{reportAddlCriteria1}" class="form-control form-control-sm" readonly />
      </div>
     </div>

     <!-- Row 4 -->
     <div class="row formline" style="margin-top: 10px;">
      <label class="col-sm-2">Report Date</label>
      <div class="col-sm-3">
       <input type="date" name="reportDate" class="form-control form-control-sm"
        th:value="${#dates.format(Data.reportDate, 'yyyy-MM-dd')}" readonly />
      </div>
     </div>

     <!-- Update Button -->
     <div style="text-align: center; margin-top: 20px;">
      <button type="button" class="custom-tab-btn" th:if="${formmode == 'edit'}" onclick="submitUpdate()">Update</button>
     </div>
    </form>
   </div>
  </div>

 </div>



 </div>



 <div class="modal fade" id="loader" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
   <div class="modal-content" style="background: transparent;">
    <div class="modal-body" style="text-align: center">
     <div>
      <img th:src=@{/images/loader.gif} id="bfirelogo"
       style="width: 153px; height: auto; margin-left: 18px; background-color: transparent; border-color: transparent;"
       alt="Bornfire">
     </div>
    </div>
   </div>
  </div>
 </div>



 <!-- Custom Alert/Result Modal (Matches your existing style) For Modify in Summary -->
 <div class="modal fade" id="resultModal">
  <div class="modal-dialog modal-dialog-centered">
   <div class="modal-content">
    <!-- Your custom styled header -->
    <div class="menu-title-header">
     <div class="modal-title" id="resultModalLabel" style="text-align: center; color: white;">
      <!-- Title will be set by JavaScript -->
     </div>
    </div>
    <div class="modal-body" style="text-align: center; font-size: 1.1rem;">
     <p id="resultModalBody"></p>
     <!-- Your custom styled button -->
     <button type="button" class="custom-tab-btn" onclick="closemodels()" data-dismiss="modal">ok</button>
    </div>
   </div>
  </div>
 </div>
 <!-- For Edit in Detail page -->
 <div class="modal fade" id="resultModal1">
  <div class="modal-dialog modal-dialog-centered">
   <div class="modal-content">
    <!-- Your custom styled header -->
    <div class="menu-title-header">
     <div class="modal-title" id="resultModalLabel1" style="text-align: center; color: white;">
      <!-- Title will be set by JavaScript-->
     </div>
    </div>
    <div class="modal-body" style="text-align: center; font-size: 1.1rem;">
     <p id="resultModalBody1"></p>

     <button type="button" class="custom-tab-btn" onclick="closemodel()" data-dismiss="modal">OK</button>
    </div>
   </div>
  </div>
 </div>

 <!-- Custom Cellresult Modal -->
 <div class="modal fade" id="cellresultModal">
  <div class="modal-dialog modal-dialog-centered">
   <div class="modal-content">

    <!-- Custom header -->
    <div class="menu-title-header" style="background-color: #6c7a91; padding: 8px; border-radius: 5px 5px 0 0;">
     <div class="modal-title" id="cellresultModalLabel" style="text-align: center; color: white;">Do you want to
      open the report?</div>
    </div>

    <div class="modal-body" style="text-align: center; font-size: 1.1rem;">
     <button type="button" class="custom-tab-btn cancel-btn" data-bs-dismiss="modal"
      style="margin-right: 10px; border: 2px solid #6c7a91; background: white; color: black; border-radius: 20px; padding: 5px 15px;">
      Cancel</button>
     <button type="button" class="custom-tab-btn yes-btn"
      style="background: #6c7a91; color: white; border: none; border-radius: 20px; padding: 5px 20px;">Yes</button>
    </div>
   </div>
  </div>
 </div>

</body>


<style>
/* Your existing CSS - this is the correct approach */
.scrollable-table-container {
	/* This is the key: it creates the scroll context */
	max-height: 620px;
	/* Or a suitable height like 80vh for responsive design */
	overflow-y: auto;
	border: 1px solid #ccc;
}

/* Your existing sticky header CSS, targeting the tr elements within the thead */
.scrollable-table-container thead tr:nth-child(1) {
	position: sticky;
	top: 0;
	background-color: #b3b6b9;
	z-index: 5;
}

.scrollable-table-container thead tr:nth-child(2) {
	position: sticky;
	top: 36px; /* adjust based on row height */
	background-color: #b3b6b9;
	z-index: 4;
}

.scrollable-table-container thead tr:nth-child(3) {
	position: sticky;
	top: 72px; /* Adjust based on row height */
	background-color: #b3b6b9;
	z-index: 3;
}

.scrollable-table-container thead tr:nth-child(4) {
	position: sticky;
	top: 100px; /* Adjust based on row height */
	background-color: #b3b6b9;
	z-index: 2;
}

.scrollable-table-container thead tr:nth-child(5) {
	position: sticky;
	top: 135px; /* Adjust based on row height */
	background-color: #b3b6b9;
	z-index: 1;
}
</style>


<style>
.inner {
	max-height: 600px; /* Adjust height as needed */
	overflow: auto;
	border: 1px solid #dee2e6;
}

/* Sticky thead */
#reports thead th {
	position: sticky;
	top: 0;
	background-color: #D8D8D8; /* Match Bootstrap thead-light */
	z-index: 2;
}

div.dataTables_wrapper div.dataTables_paginate {
	text-align: right !important;
	float: right !important;
	width: auto;
	margin-top: 10px;
}

/* Ensure info text (e.g., "Showing 1 to X") stays on the left */
div.dataTables_wrapper div.dataTables_info {
	float: left !important;
	margin-top: 10px;
}

.pagination {
	margin: 0;
}

.page-item.active .page-link {
	background-color: #386276;
	border-color: #386276;
}

.page-link {
	color: #386276;
}

.page-link:hover {
	color: #2a4a5c;
}

.form-select {
	display: inline-block;
	width: auto;
}

.scrollable-table-container thead tr:nth-child(1),
	.scrollable-table-container thead tr:nth-child(2),
	.scrollable-table-container thead tr:nth-child(3),
	.scrollable-table-container thead tr:nth-child(4),
	.scrollable-table-container thead tr:nth-child(5) {
	background-color: #D8D8D8; /* set header color */
}

.noborder td, tr {
	border: none !important;
	background-color: white;
}
</style>

</html>
