<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<!-- 
CREATED BY	: GOPIKA B
CREATED ON	: 12.12.2025
PURPOSE		: BRRSREPORT
-->

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}" />
    <link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}" />
    <link rel="stylesheet" th:href="@{/css/CustomButton.css}" />
    <link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon" />

    <!-- JavaScript -->
    <!-- jQuery core (required first) -->

    <!-- ‚úÖ Your manually placed jQuery validation
	<script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
	 <script th:src="/jquery/jquery.validate.min.js"></script>
	 -->

    <!-- jQuery (required first) -->
    <script th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->

    <!-- ‚úÖ jQuery Validation -->
    <script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
        th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>

    <!-- Bootstrap + Others -->
    <script th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
    <script th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
    <script th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
    <script th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>
    <script th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
    <script th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>

    <style>
        .btns {
            float: right;
            margin: 5px;
        }

        .col-sm-5 {
            padding-bottom: 15px;
        }

        .list-body {
            padding: 0px;
        }

        .error {
            color: red;
            padding-left: 10px;
        }

        .formline {
            padding-bottom: 15px;
        }

        .btn-primary {
            background-color: #e77400;
            border-color: #0c0c0c;
        }

        /* 
      .btn-primary:not (:disabled):not (.disabled).active,
      .btn-primary:not (:disabled):not (.disabled):active,
      .show > .btn-primary.dropdown-toggle {
        color: #fff;
        background-color: #cc000000;
        border-color: #161617;
      } */

        #finusertb {
            width: 460px;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button {
            padding: 0px;
        }
    </style>

    <style>
        tr {
            max-height: 5px;
        }

        div span {
            font-weight: bold;
            color: white !important;
        }

        .card {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        .card-header h5 {
            font-size: 22px;
            color: #fff;
            font-weight: 600;
        }

        .nav-tabs .nav-link {
            font-weight: 500;
            border: 1px solid #dee2e6;
            border-bottom: none;
            border-radius: 4px 4px 0 0;
            background-color: #f1f1f1;
            margin-right: 5px;
        }

        .nav-tabs .nav-link.active {
            background-color: #ffffff;
            border-color: #dee2e6 #dee2e6 #ffffff;
        }

        .table-responsive {
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }

        .table-hover tbody tr:hover {
            background-color: #f3f6f9;
        }

        thead th {
            position: sticky;
            top: 0;
            background-color: #e9ecf0;
            z-index: 1;
        }

        .table td {
            background-color: #ffffff;
        }

        .card-footer {
            padding: 10px;
            border-top: 1px solid #ccc;
        }

        .btn-xs {
            padding: 4px 12px;
            font-size: 14px;
            border-radius: 4px;
        }

        #BRFvalidation th,
        #usertable td {
            vertical-align: middle;
            text-align: left;
            font-size: 16px;
            font-family: Arial;
        }

        .fa-edit:hover {
            color: #28a745;
            transform: scale(1.1);
        }

        td {
            border: 1px solid rgb(0, 164, 166);
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
    </style>

    <style>
        .form-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .form-control {
            width: 100%;
            border: 2px solid #ccc;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            background: transparent;
            transition: border-color 0.3s ease, padding-top 0.3s ease;
        }

        .error {
            color: red;
            padding-top: 15px;
        }

        .form-control:focus {
            border-color: #007bff;
        }

        .form-legend {
            position: absolute;
            top: 50%;
            left: 15px;
            transform: translateY(-50%);
            font-size: 1rem;
            color: #aaa;
            background: white;
            padding: 0 5px;
            pointer-events: none;
            transition: 0.3s ease;
        }

        /* When input or select is focused or has a value, move the label up 
      .form-control:focus ~ .form-legend,
      .form-control:not (:placeholder-shown) ~ .form-legend {
        top: -8px;
        font-size: 1rem;
        color: #007bff;
      }

      /* Hover effect when the input/select is focused 
      .form-control:focus:hover ~ .form-legend {
        color: #0056b3;
        /* Darker shade of blue on hover 
      }

      /* Ensure the label returns to the normal color after focus or hover is removed 
      .form-control:not (:focus) ~ .form-legend {
        color: #aaa;
        /* Normal label color 
      } */
    </style>

    <style>
        /* Red border for invalid inputs */
        input.error,
        select.error {
            border: 2px solid red !important;
        }

        /* Error message style */
        label.error {
            color: red;
            font-size: 0.85em;
            margin-top: 5px;
            display: block;
        }

        .underline {
            text-decoration: underline;
            color: #08a6f1;
            cursor: pointer;
        }

        .left-arrow-circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            transition: background-color 0.3s, transform 0.2s;
        }

        .left-arrow-circle i {
            color: rgb(107, 122, 143);
        }

        .left-arrow-circle:hover {
            background-color: rgb(107, 122, 143);
            cursor: pointer;
            transform: scale(1.05);
            border: 2px solid white;
        }

        .left-arrow-circle:hover i {
            color: white;
        }

        .white-text span {
            color: white !important;
        }

        .table-cell tbody td:hover {
            background-color: #f0f0f0;
            /* Hover color for cell */
            cursor: pointer;
            /* Optional: pointer cursor */
        }

        .table-bordered td,
        .table-bordered th {
            border: 1px solid #000 !important;
        }

        .left {
            text-align: right;
        }

        #color {
            background-color: rgb(107, 122, 143);
            color: white;

            font-weight: bold;
        }
    </style>
    <script th:inline="javascript">
        $(document).ready(function () {
            var table = $('#reportdetail').DataTable({
                scrollY: "550px",
                scrollX: true,
                scrollCollapse: true,
                autoWidth: false,
                paging: true,
                searching: true,
                lengthChange: false,
                ordering: true,
                pageLength: 100,
                fixedHeader: true, // ‚úÖ You can simply set it to true
                // ‚úÖ Column width settings
                columnDefs: [
                    { width: "60px", targets: 0 },
                    { width: "100px", targets: 1 },
                    { width: "250px", targets: 5 },
                    { width: "250px", targets: 7 },

                    // ‚≠ê Right align these 5 columns
                    { className: "dt-right", targets: [3, 4, 5, 7, 8] }
                ],

                dom: '<"d-flex justify-content-between align-items-center mb-2"f p>t'
            });

            // ‚úÖ Fix alignment on resize / zoom
            $(window).on('resize', function () {
                table.columns.adjust().draw(false);
            });

            // ‚úÖ Fix initial misalignment if loaded at non-100% zoom
            setTimeout(function () {
                table.columns.adjust().draw(false);
            }, 500);
        });
    </script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        const reportId = /*[[${reportid}]]*/ null;
        /*]]>*/
        let isDetailsModal = false;
        $(document).ready(function () {
            // hide loader on normal load
            $('#loader').modal('hide');
        });

        $(window).on('pageshow', function () {
            // hide loader on back/forward nav
            $('#loader').modal('hide');
        });

        $(window).on('beforeunload', function () {
            // hide loader on leaving page
            $('#loader').modal('hide');
        });



        function home() {
            $("#loader").modal("toggle");
            location.href = 'Dashboard'
        }

        function back() {
            $("#loader").modal("toggle");

            window.history.back();
        }

        //to fetch summary from the database - called from the summary button
        function showdetails() {

            var Callurl;
            $('#loader').modal('show');
            Callurl = /*[[@{'/Reports/'+${reportid}+'/Details'(asondate=${asondate},fromdate=${fromdate},todate=${todate},currency=${currency},dtltype=${dtltype},type=${type},version=${version})}]]*/
                location.href = Callurl;
            console.log(Callurl);
            /*  $.ajax({
               type: 'get',
               url: Callurl,
               beforeSend: function () {
                 $('#loader').modal('show'); // üîÑ Show loader
               },
               success: function (data) {
                 $('.content').html(data);
                 //$("#detailsbtn").addClass("active");
                 //tablepagination();
               },
               complete: function () {
                 $('#loader').modal('hide');
               },
               error: function () {
                    $('#loader').modal('hide');
                 alert("Something went wrongss. Please try again.");
                
               }
             }); */
        }

        function showsummary() {
            var loader = new bootstrap.Modal(document.getElementById('loader'), { backdrop: 'static', keyboard: false });
            loader.show();
            var Callurl = /*[[@{'/Reports/' + ${reportid} (dtltype='report', fromdate=${fromdate}, todate=${todate}, type=${type},version=${version}, asondate=${asondate})}]]*/
                location.href = Callurl;

        }
    </script>

    <script>

        function activateTab(tabName) {
            // Remove 'active' from all buttons
            document.querySelectorAll('.custom-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Add 'active' to selected button
            if (tabName === 'summary') {
                document.getElementById('custom-tab-btnSummary').classList.add('active');
            } else if (tabName === 'Details') {
                document.getElementById('custom-tab-btnDetails').classList.add('active');
            }
        }

        window.onload = function () {
            /* setTimeout(function() {
                var selectedTab = document.getElementById("selectedTab").value;
                alert(selectedTab);
                activateTab(selectedTab);
            }, 10000); */ // 10,000 milliseconds = 10 seconds

            var selectedTab = document.getElementById("selectedTab").value;
            activateTab(selectedTab);
        };


        function downloadfile(button) {
            var reportid = button.getAttribute('data-reportid');
            var asondate = button.getAttribute('data-asondate');
            var fromdate = button.getAttribute('data-fromdate');
            var todate = button.getAttribute('data-todate');
            var currency = button.getAttribute('data-currency');
            var subreportid = button.getAttribute('data-subreportid');
            var secid = button.getAttribute('data-secid');
            var dtltype = button.getAttribute('data-dtltype');
            var filename = button.getAttribute('data-filename');
            var type = button.getAttribute('data-type');
            var version = button.getAttribute('data-version');


            var loader = new bootstrap.Modal(document.getElementById('loader'), { backdrop: 'static', keyboard: false });
            loader.show();

            $.ajax({
                url: './downloadExcel?reportid=' + reportid +
                    '&fromdate=' + fromdate +
                    '&asondate=' + asondate +
                    '&todate=' + todate +
                    '&currency=' + currency +
                    '&subreportid=' + subreportid +
                    '&secid=' + secid +
                    '&filename=' + filename +
                    '&type=' + type +
                    '&version=' + version,
                type: 'GET',
                xhrFields: {
                    responseType: 'blob'
                },
                success: function (data) {
                    $('#loader').modal('hide');

                    if (data && data.size > 100) {
                        const blob = new Blob([data], { type: 'application/vnd.ms-excel' });
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.style.display = 'none';
                        a.href = url;
                        a.download = filename;
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);

                        showResultModal('BRRS', filename + ' downloaded successfully.');
                    } else {
                        showResultModal('Information', 'No data was available to create a download.');
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('#loader').modal('hide');
                    console.error("Download failed:", textStatus, errorThrown);
                    showResultModal('Error', 'An error occurred while downloading the file. Please try again.');
                }
            });
        }


        function closemodel() {
            $('#alert').modal('hide');
            $('#resultModal').modal('hide');

        }


    </script>

    <script>

        function startReport(button) {
            const alertMsg = document.getElementById("alertMessage");

            const filename = button.getAttribute('data-filename');
            const fromdate = button.getAttribute('data-fromdate');
            const todate = button.getAttribute('data-todate');
            const currency = button.getAttribute('data-currency');
            const dtltype = button.getAttribute('data-dtltype');
            const type = button.getAttribute('data-type');
            const version = button.getAttribute('data-version');

            const sessionfilename = sessionStorage.getItem("filename");

            if (sessionfilename === filename) {
                alertMsg.innerHTML = 'Download request already processing...';
                showAlert();
                return;
            }

            alertMsg.innerHTML = 'Download request started...';
            showAlert();

            const downloadUrl = '/BRRS/Reports/startreport'
                + '?filename=' + encodeURIComponent(filename)
                + '&fromdate=' + encodeURIComponent(fromdate)
                + '&todate=' + encodeURIComponent(todate)
                + '&currency=' + encodeURIComponent(currency)
                + '&dtltype=' + encodeURIComponent(dtltype)
                + '&type=' + encodeURIComponent(type)
                + '&version=' + encodeURIComponent(version);

            fetch(downloadUrl)
                .then(res => res.text())
                .then(jobId => {

                    alertMsg.innerHTML = 'Request received. Job ID: ' + jobId;
                    showAlert();

                    sessionStorage.setItem("jobId", jobId);
                    sessionStorage.setItem("filename", filename);

                    checkReport(jobId);
                });
        }

        function checkReport(jobId) {
            const alertMsg = document.getElementById("alertMessage");

            fetch('/BRRS/Reports/checkreport?jobId=' + encodeURIComponent(jobId))
                .then(res => res.text())
                .then(status => {

                    if (status === "READY") {
                        alertMsg.innerHTML = 'Report ready! Downloading...';
                        showAlert();

                        const filename = sessionStorage.getItem("filename");
                        downloadDetailfile(jobId, filename + ".xlsx");

                        sessionStorage.removeItem("jobId");
                        sessionStorage.removeItem("filename");

                    } else if (status === "PROCESSING") {
                        alertMsg.innerHTML = 'Report processing...';
                        showAlert();

                        setTimeout(() => checkReport(jobId), 4000);

                    } else if (status === "ERROR") {
                        alertMsg.innerHTML = 'No data available to download.';
                        showAlert();

                        sessionStorage.removeItem("jobId");
                        sessionStorage.removeItem("filename");
                    }
                });
        }
        function openMarketRiskDetail(elem, mode) {

            var type = elem.getAttribute('data-type');

            if (type === "ARCHIVAL") {
                showResultModal('BRRS', "Archived Data cannot be modified");
                return;
            }

            const acctNo = elem.getAttribute("data-acctNo");
            const asondate = elem.getAttribute("data-asondate");

            // Use the 'reportId' variable initialized above
            // Use backticks (`) for a template literal to easily include the variable
            location.href = `/BRRS/Reports/${reportId}/Detailspage?formmode=${mode}&acctNo=${acctNo}&asondate=${asondate}`;
        }

        function downloadDetailfile(jobId, filename) {

            $.ajax({
                url: '/BRRS/Reports/downloaddetailExcel?jobId=' + jobId + '&filename=' + filename,
                type: 'GET',
                xhrFields: { responseType: 'blob' },

                success: function (data) {
                    if (data && data.size > 100) {
                        const blob = new Blob([data], { type: 'application/vnd.ms-excel' });
                        const url = window.URL.createObjectURL(blob);

                        const a = document.createElement('a');
                        a.href = url;
                        a.download = filename;
                        document.body.appendChild(a);
                        a.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);

                        showResultModal('BRRS', filename + ' downloaded successfully.');
                    } else {
                        showResultModal('Information', 'No data found to download.');
                    }
                }
            });
        }

    </script>


    <script th:inline="javascript">
        function showdetailsbyRowAndColumn(a) {
            var RowId = a.getAttribute("RowId");
            var ColumnId = a.getAttribute("ColumnId");
            var cellValue = a.textContent || a.innerText;

            if (cellValue !== "0") {
                // Set dynamic message in modal (instead of confirm)
                document.getElementById("cellresultModalLabel").innerText =
                    "Do you want to open details for Row: " +
                    RowId +
                    " and Column: " +
                    ColumnId +
                    "?";

                // Show custom Bootstrap modal
                $("#cellresultModal").modal("show");

                // Handle Yes button
                document.querySelector(".yes-btn").onclick = function () {
                    $("#cellresultModal").modal("hide");

                    // Show loader
                    const loader = bootstrap.Modal.getOrCreateInstance(
                        document.getElementById("loader"),
                        {
                            backdrop: "static",
                            keyboard: false,
                        }
                    );
                    $("#loader").modal("show");

                    // Build dynamic URL
                    var Callurl =
              /*[[@{'/Reports/' + ${reportid} + '/Details'(asondate=${asondate}, fromdate=${fromdate}, todate=${todate}, currency=${currency}, dtltype=${dtltype},type=${type},version=${version})}]]*/ "";
                    Callurl += "&filter=" + encodeURIComponent(RowId + "," + ColumnId);

                    location.href = Callurl;
                };
            } else {
                // Use your custom alert modal instead of window.alert
                showResultModal(
                    "Alert",
                    "No Records available for this selected cell."
                );
            }
        }

        function submitMarketRiskUpdate() {
            const formData = $('#MarketRiskDetailForm').serialize(); // Ensure correct form ID

            // ‚úÖ Store the previous page URL
            const previousUrl = document.referrer; // same as going back once in history

            // Show loader while processing
            $('#loader').modal('show');

            $.ajax({
                url: `/BRRS/Reports/${reportId}/update`,
                type: 'POST',
                data: formData,
                success: function (response) {
                    $('#loader').modal('hide');

                    // Show message via modal
                    if (response && response.toLowerCase().includes('success')) {
                        showResultModal('BRRS', response);
                    } else {
                        showResultModal('Information', response || 'No data updated.');
                    }

                    // ‚úÖ Redirect back to the previous page after short delay
                    setTimeout(() => {
                        if (previousUrl) {
                            window.location.href = previousUrl;
                        } else {
                            // fallback: just go back if referrer not found
                            window.history.back();
                        }
                    }, 1500);
                },
                error: function (xhr, status, error) {
                    $('#loader').modal('hide');
                    console.error("Update error:", error);

                    showResultModal('Error', 'Failed to update record. Please try again.');

                    // ‚úÖ On error also return to previous page after delay
                    setTimeout(() => {
                        if (previousUrl) {
                            window.location.href = previousUrl;
                        } else {
                            window.history.back();
                        }
                    }, 1500);
                }
            });
        }
        function showResultModal(title, message) {
            // Set the text for the modal elements
            $('#resultModalLabel').text(title);
            $('#resultModalBody').text(message);

            // Show the modal
            $('#resultModal').modal('show');
        }

        function startReport(button) {
            const alertMsg = document.getElementById("alertMessage");
            const filename = button.getAttribute('data-filename');
            const fromdate = button.getAttribute('data-fromdate');
            const todate = button.getAttribute('data-todate');
            const currency = button.getAttribute('data-currency');
            const dtltype = button.getAttribute('data-dtltype');
            const type = button.getAttribute('data-type');
            const version = button.getAttribute('data-version');
            const sessionfilename = sessionStorage.getItem("filename");

            if (sessionfilename == filename) {
                alertMsg.innerHTML = 'Download request already Processing...';
                showAlert();
                return;
            }

            alertMsg.innerHTML = 'Download request Processing...';
            showAlert();

            const baseUrl = '/BRRS/Reports/startreport';
            const downloadUrl = baseUrl +
                '?filename=' + encodeURIComponent(filename) +
                '&fromdate=' + encodeURIComponent(fromdate) +
                '&todate=' + encodeURIComponent(todate) +
                '&currency=' + encodeURIComponent(currency) +
                '&dtltype=' + encodeURIComponent(dtltype) +
                '&type=' + encodeURIComponent(type) +
                '&version=' + encodeURIComponent(version);
            fetch(downloadUrl)  // ‚úÖ no invalid characters now
                .then(res => res.text())
                .then(jobId => {

                    alertMsg.innerHTML = 'Download request received...' + jobId;
                    showAlert();
                    sessionStorage.setItem("jobId", jobId);
                    sessionStorage.setItem("filename", filename);
                    checkReport(jobId);
                });
        }

        function checkReport(jobId) {
            const alertMsg = document.getElementById("alertMessage");
            fetch('/BRRS/Reports/checkreport?jobId=' + encodeURIComponent(jobId))
                .then(res => res.text())
                .then(status => {
                    if (status === "READY") {
                        alertMsg.innerHTML = 'Report is ready! Downloaded';
                        showAlert();
                        const filename = sessionStorage.getItem("filename");
                        downloadDetailfile(jobId, filename)
                        sessionStorage.removeItem("jobId");
                        sessionStorage.removeItem("filename");

                    } else if (status === "PROCESSING") {
                        alertMsg.innerHTML = 'Download Is Processing‚Ä¶';
                        showAlert();
                        setTimeout(() => checkReport(jobId), 5000);
                    }
                    else if (status === "ERROR") {
                        alertMsg.innerHTML = 'No data was available to create a download.';
                        showAlert();
                        sessionStorage.removeItem("jobId");
                        sessionStorage.removeItem("filename");
                    }
                });
        }



        function downloadDetailfile(jobId, filename) {

            //$('#loader').modal('show');

            $.ajax({
                url: '/BRRS/Reports/downloaddetailExcel?jobId=' + jobId +
                    '&filename=' + filename,
                type: 'GET',
                xhrFields: {
                    responseType: 'blob'
                },
                success: function (data) {
                    $('#loader').modal('hide');

                    if (data && data.size > 100) {
                        const blob = new Blob([data], { type: 'application/vnd.ms-excel' });
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.style.display = 'none';
                        a.href = url;
                        a.download = filename;
                        document.body.appendChild(a);
                        a.click();
                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(a);

                        showResultModal('BRRS', filename + ' downloaded successfully');
                    } else {
                        showResultModal('Information', 'No data was available to create a download.');
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('#loader').modal('hide');
                    console.error("Download failed:", textStatus, errorThrown);
                    showResultModal('Error', 'An error occurred while downloading the file. Please try again.');
                }
            });
        }



    </script>

    <script>

        function calculateR12() {
            let B = parseFloat($("#r12_cost").val().replace(/,/g, "")) || 0;
            let C = parseFloat($("#r12_add").val().replace(/,/g, "")) || 0;
            let D = parseFloat($("#r12_disposals").val().replace(/,/g, "")) || 0;
            let E = parseFloat($("#r12_depreciation").val().replace(/,/g, "")) || 0;

            let F = B + C - D - E;

            // Format with commas
            $("#r12_net_book_value").val(F.toLocaleString("en-IS"));
        }

        function calculateR28Totals() {
            let cost = 0, monthly = 0, accumulated = 0, closing = 0;

            for (let i = 23; i <= 27; i++) {

                let cR = parseFloat($("#r" + i + "_cost_rev").val().replace(/,/g, "")) || 0;
                let mA = parseFloat($("#r" + i + "_month_amort").val().replace(/,/g, "")) || 0;
                let AAA = parseFloat($("#r" + i + "_acc_amort_amt").val().replace(/,/g, "")) || 0;
                let cB = parseFloat($("#r" + i + "_close_bal").val().replace(/,/g, "")) || 0;

                cost += cR;
                monthly += mA;
                accumulated += AAA;
                closing += cB;
            }

            $("#r28_cost_rev").val(cost.toLocaleString('en-IS'));
            $("#r28_month_amort").val(monthly.toLocaleString('en-IS'));
            $("#r28_acc_amort_amt").val(accumulated.toLocaleString('en-IS'));
            $("#r28_close_bal").val(closing.toLocaleString('en-IS'));
        }


        $(document).ready(function () {

            // Run on page load
            calculateR28Totals();
            calculateR12();

            // Auto-calc for rows 23-27 (R28 summary)
            for (let i = 23; i <= 28; i++) {
                $("#r" + i + "_cost_rev, #r" + i + "_month_amort, #r" + i + "_acc_amort_amt, #r" + i + "_close_bal")
                    .on("input", calculateR28Totals);
            }

            // Auto-calc R12 whenever any column changes
            $("#r12_cost, #r12_add, #r12_disposals, #r12_depreciation")
                .on("input", calculateR12);

        });

        function showmodify(btn) {
            // ‚úÖ List of IDs that should ALWAYS remain readonly
            var readonlyIds = [
                "r10_net_book_value", "r11_net_book_value", "r12_net_book_value", "r13_net_book_value",
                "r14_net_book_value", "r15_net_book_value", "r16_net_book_value", "r17_net_book_value",
                "r17_cost", "r17_fix_ass", "r17_add", "r17_disposals", "r17_depreciation",
                "r10_fix_ass", "r12_fix_ass", "r13_fix_ass", "r14_fix_ass", "r15_fix_ass", "r16_fix_ass",
                "r28_close_bal", "r28_acc_amort_amt", "r28_month_amort", "r28_res_value", "r28_intangible_ass",
                "r28_useful_life", "r28_cost_rev"
            ];

            // ‚úÖ Make all .Show_input editable except readonly IDs
            $(".Show_input").each(function () {
                if (!readonlyIds.includes(this.id)) {
                    $(this).prop("readonly", false).prop("disabled", false);
                }
            });

            // ‚úÖ Change background color for R23-R27 fields
            for (let i = 23; i <= 27; i++) {
                let fields = [
                    "_cost_rev",
                    "_month_amort",
                    "_acc_amort_amt",
                    "_close_bal",
                    "_useful_life",
                    "_res_value"
                ];

                fields.forEach(field => {
                    let selector = `#r${i}${field}`;
                    if ($(selector).length) {
                        $(selector).css("background-color", "#d3d3d3");
                    }
                });
            }

            // ‚úÖ Prepare R12 fields for editing
            let r12Fields = ["_cost", "_add", "_disposals", "_depreciation"];
            r12Fields.forEach(field => {
                let selector = `#r12${field}`;
                if ($(selector).length) {
                    $(selector).prop("readonly", false).prop("disabled", false)
                        .css("background-color", "#d3d3d3");
                }
            });

            // ‚úÖ Toggle buttons visibility
            $("#submitButton").show();
            $("#cancelRecord").show();
            $(btn).hide(); // hide the clicked Modify button
        }


        function fileuploads(btn) {
            const asondate = btn.getAttribute("data-todate");
            const type = btn.getAttribute("data-type");

            $('#loader').modal('show');

            try {
                // Step 1: Calculate totals
                calculateR28Totals();
                calculateR12();

                // Step 2: Remove commas
                $("#fileupload input[type='text']").each(function () {
                    $(this).val($(this).val().replace(/,/g, ''));
                });

                // Step 3: Serialize form
                let formData = $('#fileupload').serialize() + "&asondate=" + asondate + "&todate=" + asondate + "&type=" + type;

                // Step 4: AJAX
                $.ajax({
                    url: './M_FASupdateAll',
                    type: 'POST',
                    data: formData,
                    dataType: 'text',
                    success: function () {
                        $("#resultModalLabel").text("BRRS");
                        $("#resultModalBody").text("Updated Successfully.");
                        $("#resultModal").modal("show");
                    },
                    error: function (jqXHR) {
                        console.error("Error response:", jqXHR.responseText);
                        $("#resultModalLabel").text("Error");
                        $("#resultModalBody").text("Update failed. Check console for details.");
                        $("#resultModal").modal("show");
                    }
                });

            } catch (error) {
                console.error("Error in fileuploads function:", error);
                $('#loader').modal('hide');
                $("#resultModalLabel").text("Error");
                $("#resultModalBody").text("Unexpected error occurred. Check console.");
                $("#resultModal").modal("show");
            }
        }
        function cancelModify() {
            if (confirm("Are you sure you want to cancel changes? Page will reload.")) {
                // ‚úÖ Only when user clicks YES
                location.reload();

                $(".Show_input").attr("readonly", true).attr("disabled", true);



                $("#submitButton, #btnBack_edit").hide();
                $("#btnBack").show();

                // Hide Cancel button again
                $("#cancelRecord").hide();

                // Show all Modify buttons
                $("#addRecord").show();
            }
            // ‚ùå If user clicks CANCEL, nothing happens
        }

    </script>



    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px auto;
            font-family: Arial, sans-serif;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .header-row th {
            background-color: #cccccc;
            text-align: center;
        }

        .group-header th {
            background-color: #a9a9a9;
            font-weight: bold;
        }

        .total-row td {
            font-weight: bold;
            background-color: #f2f2f2;
        }
    </style>
    </style>
    <style>
        .left-arrow-circle {
            background-color: white;
            color: #007bff;
            border-radius: 50%;
            padding: 8px;
            margin-right: 10px;
            cursor: pointer;
        }

        /* üöå Bus display style box */
        /* üöå Bus display style box */
        .boards {
            transform: translateY(6px);
            background-color: rgb(107, 122, 143);
            color: white;
            padding: 5px 80px;
            border-radius: 8px;
            overflow: hidden;
            white-space: nowrap;
            flex: 1;
            /* ‚úÖ makes it take available space dynamically */
            min-width: 200px;
            box-shadow: 0 0 10px rgb(107, 122, 143);
            position: relative;
        }

        /* ‚ú® Scrolling animation */
        .scrolling-text {
            display: inline-block;
            font-family: "Courier New", monospace;
            font-weight: bold;
            letter-spacing: 1px;
            animation: scroll-left 10s linear infinite;
        }

        /* Animation keyframes */
        @keyframes scroll-left {
            0% {
                transform: translateX(100%);
            }

            100% {
                transform: translateX(-100%);
            }
        }
    </style>
</head>

<title>BRRS</title>

<body>
    <div class="container-fluid" style="padding-left: 0px; padding-right: 0px">
        <div class="row">
            <div th:insert="HeaderMenu :: header"></div>

            <div class="card">
                <div class="card-header" style="
              background-color: rgb(107, 122, 143);
              display: flex;
              align-items: center;
              justify-content: space-between;
            ">
                    <div style="display: flex; align-items: center" onclick="back();">
                        <!-- ‚¨ÖÔ∏è Left circular arrow -->
                        <div class="left-arrow-circle">
                            <i class="fa fa-arrow-left"></i>
                        </div>

                        <!-- Title -->
                        <h5 style="
                  font-family: arial;
                  font-size: 20px;
                  padding-top: 10px;
                  font-weight: bold;
                  color: white;
                "> Table 34 Market risk: disclosures for banks using the standardised approach


                        </h5>
                        <div class="boards">
                            <p class="scrolling-text">BANK OF BOTSWANA - BANKING SUPERVISION DEPARTMENT </p>
                        </div>
                    </div>

                    <div class="custom-tab-btn-group nav-buttons"
                        style="display: flex; color: white; align-items: center">
                        <!-- üìÖ Date -->
                        <span class="white-text"
                            style="color: white !important; font-size: 16px; margin-right: 20px;">Report Date:
                            <span th:text="${#strings.replace(asondate, '/', '-')}">2025-07-04</span>
                        </span>

                        <!-- Buttons -->
                        <input type="hidden" id="selectedTab" th:value="${displaymode}" />
                        <button type="button" class="custom-tab-btn" id="custom-tab-btnSummary" onclick="showsummary();"
                            th:if="${displaymode == 'Details'}">
                            Summary
                        </button>
                        <button type="button" class="custom-tab-btn" id="custom-tab-btnDetails" onclick="showdetails();"
                            th:if="${displaymode == 'summary'}">
                            Details
                        </button>
                        <!-- Modify button -->
                        <!-- <button type="button" class="custom-tab-btn" onclick="showmodify(this);"
                            title="Click to EDIT Records" th:if="${type != 'ARCHIVAL'}"
                            th:classappend="${session.PERMISSIONS == 'W'} AND ${dtltype == 'report'} ? addedit "
                            id="addRecord">Modify</button> -->
                        <button type="button" class="custom-tab-btn" title="Cancel editing" id="cancelRecord"
                            onclick="cancelModify();" style="display: none;">Cancel</button>
                        <button type="button" class="custom-tab-btn" id="custom-tab-btnAdd"
                            th:if="${displaymode == 'summary'}" th:attr="data-reportid=${reportid}, 
                    				 data-asondate=${asondate}, 
                    				 data-fromdate=${fromdate}, 
                     				 data-todate=${todate}, 
                     				 data-currency=${currency},  
                     				 data-dtltype=${dtltype}, 
                     				 data-filename='MarketRisk.xlsx',
					 				 data-type=${type},
					    			 data-version=${version}" onclick="downloadfile(this);">
                            <i class="fa fa-download"></i>
                        </button>
                        <button type="button" class="custom-tab-btn" id="custom-tab-btnAdd"
                            th:if="${displaymode == 'Details'}" onclick="startReport(this);" th:attr="
						    data-fromdate=${fromdate},
						    data-todate=${todate},
						    data-filename='Market_Risk',
                data-type=${type},
		            data-version=${version}
						  ">
                            <i class="fa fa-download"></i>
                        </button>

                    </div>
                </div>

                <div th:if="${displaymode == 'summary'}">
                    <div class="row">

                        <div class="col-sm-6 ">
                            <form action="#" method="POST" id="fileupload">
                                <div class="table-wrapper table-responsive scrollable-table-container "
                                    style="border-right: 1px solid #ffffff;">
                                    <table class="table table-bordered table-hover table-sm">
                                        <thead>
                                            <p style="text-align: center; font-weight: bold; padding-top: 10px;">Table
                                                34 Market risk: disclosures for banks using the standardised approach
                                            </p>

                                        </thead>
                                        <tbody style="font-family: Arial" th:each="reportsummary: ${reportsummary}">

                                            <tr>
                                                <td th:text="${reportsummary.R5_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;font-weight: bold; width: 400px;"></td>
                                                <td th:text="${reportsummary.R5_PRODUCT}"style="width: 380px;"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R5_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}"  style="text-align:right;width:390px"
                                                    th:attr="RowId='R5', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>
                                            
                                            <tr>
                                                <td th:text="${reportsummary.R6_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;font-weight: bold;"></td>
                                                <td th:text="${reportsummary.R6_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R6_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R6', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                        </tbody>
                                    </table>
                                    <table class="table table-bordered table-hover table-sm">
                                        <thead>
                                            <p style="text-align: center; font-weight: bold;">Table 35 Equities:
                                                disclosures for banking book positions</p>

                                        </thead>
                                        <tbody style="font-family: Arial" th:each="reportsummary: ${reportsummary}">

                                            <tr>
                                                <td th:text="${reportsummary.R11_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;font-weight: bold;width: 400px;"></td>
                                                <td th:text="${reportsummary.R11_PRODUCT}" style="width: 380px;"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R11_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;width: 390px;"
                                                    th:attr="RowId='R11', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <td th:text="${reportsummary.R12_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;text-align: left;font-weight: bold;padding-top: 70px;"
                                                    rowspan="5"></td>
                                                <td th:text="${reportsummary.R12_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R12_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R12', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <!-- <td th:text="${reportsummary.R13_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;"></td> -->
                                                <td th:text="${reportsummary.R13_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R13_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R13', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <!-- <td th:text="${reportsummary.R14_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;"></td> -->
                                                <td th:text="${reportsummary.R14_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R14_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R14', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <!-- <td th:text="${reportsummary.R15_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;"></td> -->
                                                <td th:text="${reportsummary.R15_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R15_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}"style="text-align:right;"
                                                    th:attr="RowId='R15', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <!-- <td th:text="${reportsummary.R16_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;"></td> -->
                                                <td th:text="${reportsummary.R16_PRODUCT}"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R16_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R16', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                        </tbody>
                                    </table>

                                    <table class="table table-bordered table-hover table-sm">
                                        <thead>
                                            <p style="text-align: center; font-weight: bold;">Table 36 Interest rate
                                                risk the banking book (IRRBB)</p>

                                        </thead>
                                        <tbody style="font-family: Arial" th:each="reportsummary: ${reportsummary}">

                                            <tr>
                                                <td th:text="${reportsummary.R20_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;font-weight: bold;width: 400px;"></td>
                                                <td th:text="${reportsummary.R20_PRODUCT}" style="width: 380px;"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R20_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;"
                                                    th:attr="RowId='R20', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>

                                            <tr>
                                                <td th:text="${reportsummary.R21_QUALITATIVE_DISCLOSURES}"
                                                    style="padding-left: 20px;font-weight: bold;"></td>
                                                <td th:text="${reportsummary.R21_PRODUCT}" style="width: 180px;"></td>
                                                <td th:text="${#numbers.formatDecimal(reportsummary.R21_QUAN_DIS, 0, 'COMMA', 0, 'POINT')}" style="text-align:right;width:390px"
                                                    th:attr="RowId='R21', ColumnId='C4'"
                                                    onclick="showdetailsbyRowAndColumn(this)"></td>
                                            </tr>


                                        </tbody>
                                    </table>
                                </div>

                        </div>

                        <button id="submitButton" type="button" class="custom-tab-btn Show_input" form="fileupload"
                            th:attr="data-todate=${asondate},data-type=${type}" onclick="fileuploads(this);"
                            style="display: none;">
                            Submit </button>
                    </div>

                    </form>
                </div>


            </div>
        </div>
        <!-- ------------------- -->
        <div th:if="${displaymode == 'Details'}">
            <div class="row">
                <div class="col-sm-12">
                    <div class="table-responsive scrollable-table-container" style="border-right: 1px solid #dee2e6;">
                        <table class="table table-striped table-hover" id="reportdetail">
                            <thead class="thead-light">
                                <tr>
                                    <th></th>
                                    <th>S No</th>
                                    <th>CUST_ID</th>
                                    <th>ACCT_NUMBER</th>
                                    <th>ACCT_NAME</th>
                                    <th style="text-align:right;">ACCT_BALANCE_IN_PULA</th>
                                    <th>REPORT LABEL</th>
                                    <th>REPORT ADDL CRITERIA1</th>
                                    <th>REPORT_DATE</th>
                                </tr>

                            </thead>

                            <tbody style="font-family: Arial;">
                                <tr th:each="report, srlno : ${reportdetails}">
                                    <td>
                                        <a data-toggle="tooltip" class="editrec" title="Click to Edit this Record">
                                            <i class="fas fa-edit" style="color: black; cursor:pointer;" th:attr="data-acctNo=${report.acctNumber},
														data-asondate=${#dates.format(report.reportDate, 'dd-MM-yyyy')},data-type=${type}"
                                                onclick="openMarketRiskDetail(this, 'edit')"></i>

                                        </a>
                                    </td>


                                    <td th:text="${srlno.index + 1}"></td>
                                    <td th:text="${report.custId}"></td>
                                    <td th:text="${report.acctNumber}"></td>
                                    <td th:text="${report.acctName}"></td>
                                    <td style="text-align:right;"
                                        th:text="${#numbers.formatDecimal(report.acctBalanceInpula == null ? 0 : report.acctBalanceInpula, 1, 'COMMA', 0, 'POINT')}">
                                    </td>

                                    <td th:text="${report.reportLabel}"></td>
                                    <td th:text="${report.reportAddlCriteria1}"></td>
                                    <td th:text="${#dates.format(report.reportDate, 'dd-MM-yyyy')}"></td>
                                </tr>
                            </tbody>
                        </table>

                    </div>

                    <!-- Submit Button -->
                    <div style="text-align: center; margin-top: 15px; background-color: white;">
                        <button id="submitButton" type="button" class="custom-tab-btn Show_input"
                            onclick="updateform();" style="display: none;">
                            Submit
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div th:if="${formmode == 'edit'}" class="card">


            <div class="card-body">
                <form th:object="${MarketRiskData}" method="post" id="MarketRiskDetailForm">
                    <div class="row formline" style="margin-top:10px;">
                        <label class="col-sm-2">Customer ID</label>
                        <div class="col-sm-3">
                            <input type="text" th:field="*{custId}" class="form-control form-control-sm" readonly />
                        </div>

                        <div class="col-sm-1"></div>

                        <label class="col-sm-2">Account Number</label>
                        <div class="col-sm-3">
                            <input type="text" th:field="*{acctNumber}" name="acctNumber"
                                class="form-control form-control-sm" readonly />
                        </div>
                    </div>

                    <div class="row formline" style="margin-top:10px;">
                        <label class="col-sm-2">Account Name</label>
                        <div class="col-sm-3">
                            <input type="text" th:field="*{acctName}" class="form-control form-control-sm" readonly />
                        </div>

                        <div class="col-sm-1"></div>

                        <label class="col-sm-2">Acct Balance</label>
                        <div class="col-sm-3">
                            <input type="number" step="0.01" th:field="*{acctBalanceInpula}"
                                class="form-control form-control-sm" style="text-align:right;" />
                        </div>
                    </div>

                    <div class="row formline" style="margin-top:10px;">
                        <label class="col-sm-2">Report Label</label>
                        <div class="col-sm-3">
                            <input type="text" th:field="*{reportLabel}" class="form-control form-control-sm"
                                readonly />
                        </div>

                        <div class="col-sm-1"></div>

                        <label class="col-sm-2">Report Addl Criteria 1</label>
                        <div class="col-sm-3">
                            <input type="text" th:field="*{reportAddlCriteria1}" class="form-control form-control-sm"
                                readonly />
                        </div>
                    </div>

                    <div class="row formline" style="margin-top:10px;">
                        <label class="col-sm-2">Report Date</label>
                        <div class="col-sm-3">
                            <input type="date" name="reportDate" class="form-control form-control-sm" readonly
                                th:value="${#dates.format(MarketRiskData.reportDate, 'yyyy-MM-dd')}" />
                        </div>
                    </div>

                    <div style="text-align:center; margin-top:20px;">
                        <button type="button" class="custom-tab-btn" th:if="${formmode == 'edit'}"
                            onclick="submitMarketRiskUpdate()">Update</button>

                    </div>
                </form>
            </div>
        </div>
















    </div>



    </div>



    <div class="modal fade" id="loader" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content" style="background: transparent;">
                <div class="modal-body" style="text-align: center">
                    <div>
                        <img th:src=@{/images/loader.gif} id="bfirelogo"
                            style="width: 153px; height: auto; margin-left: 18px; background-color: transparent; border-color: transparent;"
                            alt="Bornfire">
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Custom Alert/Result Modal (Matches your existing style) -->
    <div class="modal fade" id="resultModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Your custom styled header -->
                <div class="menu-title-header">
                    <div class="modal-title" id="resultModalLabel" style="text-align: center; color: white;">
                        <!-- Title will be set by JavaScript -->
                    </div>
                </div>
                <div class="modal-body" style="text-align: center; font-size: 1.1rem;">
                    <p id="resultModalBody"></p>
                    <!-- Your custom styled button -->
                    <button type="button" class="custom-tab-btn" onclick="closemodel()" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>



    <!-- Custom Cellresult Modal -->
    <div class="modal fade" id="cellresultModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Custom header -->
                <div class="menu-title-header"
                    style="background-color: #6c7a91; padding: 8px; border-radius: 5px 5px 0 0;">
                    <div class="modal-title" id="cellresultModalLabel" style="text-align: center; color: white;">Do
                        you want to
                        open the report?</div>
                </div>

                <div class="modal-body" style="text-align: center; font-size: 1.1rem;">
                    <button type="button" class="custom-tab-btn cancel-btn" data-bs-dismiss="modal"
                        style="margin-right: 10px; border: 2px solid #6c7a91; background: white; color: black; border-radius: 20px; padding: 5px 15px;">
                        Cancel</button>
                    <button type="button" class="custom-tab-btn yes-btn"
                        style="background: #6c7a91; color: white; border: none; border-radius: 20px; padding: 5px 20px;">
                        Yes</button>
                </div>
            </div>
        </div>
    </div>



</body>


<style>
    /* Your existing CSS - this is the correct approach */
    .scrollable-table-container {
        /* This is the key: it creates the scroll context */
        max-height: 750px;
        /* Or a suitable height like 80vh for responsive design */
        overflow-y: auto;
        border: 1px solid #ccc;
    }

    /* Your existing sticky header CSS, targeting the tr elements within the thead */
    .scrollable-table-container thead tr:nth-child(1) {
        position: sticky;
        top: 0;
        background-color: #b3b6b9;
        z-index: 5;
    }

    .scrollable-table-container thead tr:nth-child(2) {
        position: sticky;
        top: 36px;
        /* adjust based on row height */
        background-color: #b3b6b9;
        z-index: 4;
    }

    .scrollable-table-container thead tr:nth-child(3) {
        position: sticky;
        top: 72px;
        /* Adjust based on row height */
        background-color: #b3b6b9;
        z-index: 3;
    }

    .scrollable-table-container thead tr:nth-child(4) {
        position: sticky;
        top: 100px;
        /* Adjust based on row height */
        background-color: #b3b6b9;
        z-index: 2;
    }

    .scrollable-table-container thead tr:nth-child(5) {
        position: sticky;
        top: 135px;
        /* Adjust based on row height */
        background-color: #b3b6b9;
        z-index: 1;
    }
</style>


<style>
    .inner {
        max-height: 600px;
        /* Adjust height as needed */
        overflow: auto;
        border: 1px solid #dee2e6;
    }

    /* Sticky thead */
    #reports thead th {
        position: sticky;
        top: 0;
        background-color: #f8f9fa;
        /* Match Bootstrap thead-light */
        z-index: 2;
    }

    div.dataTables_wrapper div.dataTables_paginate {
        text-align: right !important;
        float: right !important;
        width: auto;
        margin-top: 10px;
    }

    /* Ensure info text (e.g., "Showing 1 to X") stays on the left */
    div.dataTables_wrapper div.dataTables_info {
        float: left !important;
        margin-top: 10px;
    }

    .pagination {
        margin: 0;
    }

    .page-item.active .page-link {
        background-color: #386276;
        border-color: #386276;
    }

    .page-link {
        color: #386276;
    }

    .page-link:hover {
        color: #2a4a5c;
    }

    .form-select {
        display: inline-block;
        width: auto;
    }
</style>





</html>