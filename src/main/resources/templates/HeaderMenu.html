<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" th:fragment="header">

<head>
	<meta charset="UTF-8">
	<title>BRRS</title>

	<!-- CSS Dependencies -->
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/datatables.min.css}">

	<link rel="stylesheet" th:href="@{/css/CustomButton.css}" />

	<!-- JS Dependencies -->
	<script th:src="@{/js/datatables.min.js}"></script>
	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>


	<style>
		body {
			font-family: Arial, sans-serif;
			font-size: 16px;
			font-weight: 400;
		}
	</style>

<style>
.btn-wrapper {
	display: flex;
	max-width: 1500px;
	position: relative;
}

.btn-container {
	display: flex;
	gap: 8px;
	overflow-x: hidden;
	padding-bottom: 500px;
	margin-bottom: -500px;
	pointer-events: none;
	scroll-behavior: smooth;
	white-space: nowrap;
}

.btn-container>* {
	pointer-events: auto;
}

.nav-arrow {
	border: none;
	background: transparent;
	cursor: pointer;
	padding: 6px 10px;
	padding-bottom: 15px;
	user-select: none;
	z-index: 10;
}

.nav-arrow:disabled {
	opacity: 0.3;
	cursor: default;
}

.px-5 {
	padding-right: 0px !important;
}
</style>

<style>
		nav {
			background-color: #fafafa;
		}

		#logoutmenu {
			display: none;
			position: absolute;
			z-index: 1031;
			width: 200px;
			background-color: #dee2e6;
			box-shadow: 3px 1px 11px 1px #888888;
			border-radius: 5px;
			right: 0px;
			top: 70px;
			border: 2px solid #4d8cb9;
			position: fixed;
		}

		#ques {
			margin-top: -54px;
			float: right;
			padding: 65px;
		}

		.logout {
			color: #2e7bd0;
		}

		.content {
			margin-top: 100px;
		}

		html {
			zoom: 0.8;
		}

		label {
			text-align: left;
		}

		.modal-backdrop {
			width: 200vw;
			height: 200vh;
		}

		section {
			padding-left: 15px;
		}

		.form-control:focus {
			color: #495057;
			outline: 0;
			box-shadow: unset !important;
		}

		.btn-primary.focus,
		.btn-primary:focus {
			box-shadow: unset !important;
		}

		.nav-link-collapse:after {
			float: right;
			content: '\f067';
			font-family: 'Font Awesome 5 Free';
			color: red;

			transform: translateY(-50%) rotate(-90deg);
		}



		ul {
			list-style: none
		}

		li a {
			color: white;
		}

		a {
			text-decoration: none !important;
		}

		#showmenu1 {
			width: 50px;
			height: 50px;
			/* Maintain the same width and height to create a circular shape */
			border-radius: 50%;
			/* Use a border-radius of 50% to create a circle */
			object-fit: fill;
			/* Ensure the image covers the circular area without distortion */
		}
	</style>


	<style>
		body {
			overflow-x: hidden;
			overflow-y: hidden;
		}

		/* First Layer */
		.first-layer {
			width: 100%;
			display: flex;
			justify-content: space-between;
			align-items: center;
			/*  padding: 10px 20px;
    border-bottom: 2px solid #ddd; */
		}

		.logo img {
			width: 100px;
			height: 80px;
		}

		.user-profile {
			display: flex;
			align-items: center;
		}

		.user-profile img {
			width: 50px;
			height: 50px;
			border-radius: 50%;
			margin-right: 10px;
			cursor: pointer;
		}

		.user-details {
			font-family: Calibri, sans-serif;
			font-size: 14px;
			font-weight: bold;
		}

		/* Second Layer */
		.second-layer {
			display: flex;
			justify-content: flex-end;
			padding: 3px 31%;
			margin-left: -215px;
		}



		.nav-item {
			position: relative;
		}

		.nav-item a {
			text-decoration: none;
			color: #333;
			font-weight: bold;
		}
	</style>


	<style>
		.nav-links a {
			/* color: #354a5f !important; */
			font-weight: bold;

			/* color: black !important; */
		}

		label {
			color: #354a5f !important;
			font-weight: bold;
			border-color: black;
			/* color: black !important; */
		}

		div span {
			color: #354a5f !important;
			font-weight: bold;
			/* color: black !important; */
		}

		h3 {
			color: #354a5f !important;
			font-weight: bold;
			/* color: black !important; */
		}
	</style>

	<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function () {
			let menuTimeout;

			// Function to show menu
			function showMenu(menu) {
				clearTimeout(menuTimeout);

				// Hide all other submenus before showing the new one
				document.querySelectorAll('.dropdown-submenu .dropdown-menu').forEach(m => {
					if (m !== menu) {
						m.style.display = "none";
					}
				});

				menu.style.display = "block";
			}

			// Function to hide menu with delay
			function hideMenu(menu) {
				menuTimeout = setTimeout(() => {
					menu.style.display = "none";
				}, 200); // 200ms delay
			}

			// Handle main dropdown menu hover 
			const mainMenus = document.querySelectorAll('.nav-item.dropdown');
			mainMenus.forEach(menu => {
				menu.addEventListener("mouseenter", function () {
					const dropdownMenu = this.querySelector(".dropdown-menu");
					if (dropdownMenu) {
						// Hide all other main dropdowns
						document.querySelectorAll('.nav-item.dropdown .dropdown-menu').forEach(m => {
							if (m !== dropdownMenu) {
								m.style.display = "none";
							}
						});
						showMenu(dropdownMenu);
					}
				});

				menu.addEventListener("mouseleave", function () {
					const dropdownMenu = this.querySelector(".dropdown-menu");
					if (dropdownMenu) hideMenu(dropdownMenu);
				});
			});

			// Handle submenus inside dropdown 
			const submenus = document.querySelectorAll('.dropdown-submenu');
			submenus.forEach(submenu => {
				submenu.addEventListener("mouseenter", function () {
					const subMenuElement = this.querySelector(".dropdown-menu");
					if (subMenuElement) showMenu(subMenuElement);
				});

				submenu.addEventListener("mouseleave", function () {
					const subMenuElement = this.querySelector(".dropdown-menu");
					if (subMenuElement) hideMenu(subMenuElement);
				});
			});

			// Close all menus when clicking outside
			document.addEventListener("click", function (e) {
				if (!e.target.closest(".dropdown")) {
					document.querySelectorAll('.dropdown-menu').forEach(menu => {
						menu.style.display = "none";
					});
				}
			});
		});



	</script>




	<style>
		body {
			display: flex;
			min-height: 100vh;
		}



		.logout-btn {
			margin-top: auto;
			padding: 12px 20px;
		}
	</style>


	<style>
		.user-details {
			color: #000;
			text-align: left;
			font-size: 0.9rem;
			line-height: 1.6;
		}



		/* Main Navigation Links - Only Visual Effects */
		.nav-link {
			display: inline-block;
			background: linear-gradient(145deg, #ffffff, #f8f9fa);
			color: white;
			font-weight: 600;
			font-size: 14px;
			border: 2px solid #6B7A8F;
			padding: 8px 20px;
			border-radius: 20px;
			text-decoration: none;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			cursor: pointer;
			position: relative;
			overflow: hidden;

			/* NO transform changes to prevent position shifts */
		}

		/* Shine Effect on Hover */
		.nav-link::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
			transition: left 0.5s;
			z-index: 1;
		}

		/* Hover Effects - Only Color and Shadow Changes */
		.nav-link:hover {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			color: white !important;

			border-color: rgb(107, 122, 143);
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
			/* NO transform to prevent movement */
		}

		.nav-link:hover::before {
			left: 100%;
		}

		/* Active/Selected State - 3D Highlight */
		.nav-link.active {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			color: white;
			border-color: rgb(107, 122, 143);
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
		}
		
		/* Dropdown Toggle Styles */
		.dropdown-toggle {
			display: inline-block;
			background: linear-gradient(145deg, #ffffff, #f8f9fa);
			color: #333;
			font-weight: 600;
			font-size: 14px;
			border: 2px solid #6B7A8F;
			padding: 8px 20px;
			border-radius: 20px;
			text-decoration: none;
			transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			cursor: pointer;
			position: relative;
			overflow: hidden;

		}

		.dropdown-toggle::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			transition: left 0.5s;
			z-index: 1;
		}

		.dropdown-toggle::after {
			content: ' ▾';
			margin-left: 6px;
			transition: transform 0.3s;
			position: relative;
			z-index: 2;
			font-size: 10px;
		}

		/* Dropdown Toggle Hover */
		.dropdown-toggle:hover {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			color: white !important;
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
		}

		.dropdown-toggle:hover::before {
			left: 100%;
		}

		.dropdown:hover .dropdown-toggle::after {
			transform: rotate(180deg);
		}

		/* Active Dropdown Toggle */
		.dropdown-toggle.active {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			color: white !important;
			border-color: rgb(107, 122, 143);
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
		}


		/* Dropdown Menu - Keep Original Positioning */
		.dropdown-menu {
			position: absolute;
			top: 100%;
			left: 0;
			background: rgba(255, 255, 255, 0.98);
			backdrop-filter: blur(10px);
			border: 2px solid rgb(107, 122, 143);
			border-radius: 12px;
			padding: 8px 0;
			margin-top: 5px;
			min-width: 200px;
			display: none;

			z-index: 1000;
			list-style: none;
		}

		/* Dropdown Animation When Shown */
		.dropdown-menu[style*="block"] {
			animation: fadeInDown 0.3s ease-out;
		}

		@keyframes fadeInDown {
			from {
				opacity: 0;
				transform: translateY(-5px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* Dropdown Menu Items */
		.dropdown-menu .nav-item {
			margin: 0;
			padding: 0;
		}

		.dropdown-menu .nav-link {
			display: block !important;
			margin: 2px 8px;
			padding: 8px 15px;
			border-radius: 8px;
			font-size: 13px;
			font-weight: 500;
			border: 1px solid transparent;
			background: transparent;
			box-shadow: none;
			transition: all 0.2s ease;
		}

		.dropdown-menu .nav-link::before {
			display: none;
		}

		.dropdown-menu .nav-link:hover {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			color: white;
			border-color: rgb(107, 122, 143);
			width: auto;
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
		}

		/* Active Dropdown Menu Item */
		.dropdown-menu .nav-link.active {
			background: linear-gradient(145deg, rgb(107, 122, 143), rgb(87, 102, 123));
			width: auto;
			color: white !important;
			border-color: rgb(107, 122, 143);
			text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
		}

		/* Focus States */
		.nav-link:focus,
		.dropdown-toggle:focus {
			outline: none;

		}

		.custom-alert {
			position: fixed;
			top: 20px;
			right: 20px;
			min-width: 250px;
			max-width: 300px;
			padding: 10px 15px;
			border-radius: 8px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
			z-index: 9999;
			font-size: 14px;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.custom-alert p {
			margin: 0;
			padding: 0;
		}

		.custom-alert .close {
			background: none;
			border: none;
			font-size: 18px;
			line-height: 1;
			cursor: pointer;
			color: #000;
			padding-left: 10px;
		}


		.nav-link.active,
		.dropdown-toggle.active {
			animation: subtlePulse 2s ease-in-out infinite;
		}

		/* Responsive - Keep Layout Intact */
		@media (max-width: 768px) {
			.nav-links {
				gap: 10px;
				flex-wrap: wrap;
			}

			.nav-link,
			.dropdown-toggle {
				font-size: 13px;
				padding: 6px 16px;
			}

			.dropdown-menu {
				min-width: 180px;
				margin-top: 3px;
			}
		}
	</style>


	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const currentPath = window.location.pathname;
			const urlParams = new URLSearchParams(window.location.search);
			const formMode = urlParams.get('formmode');
			const navLinks = document.querySelectorAll(".nav-link");

			function activateParentDropdowns(activeLink) {

				let parentMenu = activeLink.closest('.dropdown-menu');
				while (parentMenu) {
					const parentItem = parentMenu.closest('.dropdown-submenu, .nav-item.dropdown');
					if (parentItem) {
						const parentToggle = parentItem.querySelector('.dropdown-toggle, .nav-link');
						if (parentToggle) {
							parentToggle.classList.add("active");
						}
					}
					parentMenu = parentMenu.parentElement.closest('.dropdown-menu');
				}
			}

			navLinks.forEach(link => {
				const href = link.getAttribute("href");
				if (!href || href === "#") return;

				const linkUrl = new URL(href, window.location.origin); // ✅ Resolve to full URL
				const linkPath = linkUrl.pathname;
				//const linkFormMode = linkUrl.searchParams.get('formmode') || link.getAttribute("data-formmode");
				const linkFormMode = urlParams.get('formmode');

				if (currentPath === linkPath) {

					if (formMode || linkFormMode) {
						if (formMode === linkFormMode) {
							link.classList.add("active");
							activateParentDropdowns(link);
						}
					} else {
						link.classList.add("active");
						activateParentDropdowns(link);
					}
				}
			});
		});
	</script>


	<style>
		.navbar-container {
			display: flex;
			align-items: stretch;
		}

		.logo-container {
			background-color: #488f9d;
			padding: 10px;
		}

		.logo-img {
			height: 100%;
			width: 250px;
			object-fit: cover;
			max-height: 150px;
			/* Adjust based on your actual content height */
		}

		.right-content {
			display: flex;
			flex-direction: column;
			justify-content: space-between;

		}

		.top-row {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.company-title {
			font-weight: bold;
			color: #343a40;
		}

		.bottom-row {
			border-top: 1px solid #ddd;
			margin-top: 4px;
		}

		.nav-links {
			list-style: none;
			padding-left: 0;
			margin: 0;
			display: flex;
			align-items: center;
		}

		.nav-item {
			position: relative;
		}

		.nav-link {
			text-decoration: none;
			color: #333;
			font-weight: 5000;
			padding: 6px 12px;
		}

		.dropdown-menu {
			display: none;
			position: absolute;
			top: 100%;
			left: 0;
			background: white;
			list-style: none;
			padding: 10px 0;
			margin: 0;
			border: 1px solid #ccc;
			z-index: 1000;
		}

		.nav-item:hover .dropdown-menu {
			display: none;
		}

		.logo-container {
			overflow: hidden;
			transform: skew(-30deg);
			/* Skew the container */
		}

		.logo-img {
			transform: skew(20deg);
			/* Re-skew the image to appear normal */
			height: 100px;
			/* Adjust height as needed */
			width: auto;
			padding: 10px
		}

		.navbar-container {
			display: flex;
			align-items: stretch;
			width: 100%;
		}

		.logo-container {
			background-color: rgb(255, 255, 255);
			padding: 0;
			/* Remove extra space */
			overflow: hidden;
			transform: skew(-30deg);
			margin-right: -30px;
			/* Pull right content to cover the skew gap */
			z-index: 2;
		}

		.logo-img {
			height: 50px;
			width: auto;
			padding: 5px;
			padding-bottom: 0;
		}

		/* Right side (full height, no space left) */
		.right-content {
			display: flex;
			flex-direction: column;
			justify-content: space-between;

			flex-grow: 1;
			z-index: 1;
		}

		/* Skew only top row */
		.top-row {
			transform: skew(-30deg);
			padding: 10px;
			position: relative;
		}

		/* Correct skew for content inside */
		.top-row>* {
			transform: skew(30deg);
		}

		/* Bottom menu stays normal */
		.bottom-row {
			border-top: 1px solid #ddd;
			margin-top: 4px;
		}

		.company-title {
			transform: skew(30deg) translateX(-50%) translateY(-50%) !important;
		}

		.nav-link {
			color: white;
		}




		/* Add spacing between dropdown items */
		.dropdown-menu li {
			padding: -8px 12px;
			/* Adjust vertical and horizontal padding */
			margin-bottom: 5px;
			/* Space between items */
		}

		/* Remove bottom margin for the last item to avoid extra space */
		.dropdown-menu li:last-child {
			margin-bottom: 0;
		}

		/* Style for links inside dropdown */
		.dropdown-menu a {
			display: block;
			color: #354a5f !important;
			padding: 8px 12px;
			/* Adjust spacing inside links */
		}


		.dropdown-submenu>a {
			display: flex;
			justify-content: space-between;
			align-items: center;
			width: 100%;
			padding: 10px;
			position: relative;
		}

		/* Black arrow with proper alignment */
		.dropdown-submenu>a::after {
			content: "";
			/* Thicker right arrow */
			font-size: 16px;
			/* Bigger size */
			color: #354a5f;
			/* Black color */
			font-weight: bold;
			position: absolute;
			right: 10px;
			top: 50%;
			transform: translateY(-50%) rotate(-90deg);
		}

		/* Position the second-level (submenu) */
		.dropdown-submenu {
			position: relative;
		}

		.dropdown-submenu>.dropdown-menu {
			display: none;
			position: absolute;
			left: 100%;
			top: 0;
			margin-top: -12px;
		}

		/* Show only the relevant submenu on hover */
		.dropdown-submenu:hover>.dropdown-menu {
			display: block;
		}

		/* Ensure the top-level menu dropdowns show on hover */
		.dropdown:hover>.dropdown-menu {
			display: block;
		}
	</style>

	<style type="text/css">
		.user-menu {
			position: relative;
			display: inline-block;
			cursor: pointer;
			font-size: 30px;
			font-weight: bold;
			user-select: none;
			z-index: 10000;
		}

		.three-dots {
			padding: 0 10px;
			color: #333;
		}

		.user-dropdown-menu {
			position: absolute;
			right: 100%;
			margin-left: -170px;
			transform: translateX(-10px);
			display: none;
			background-color: white;
			border: 1px solid #ccc;
			border-radius: 6px;
			padding: 10px;
			white-space: nowrap;
			width: max-content;
			max-width: 300px;
			/* Prevent overly wide dropdowns */
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			z-index: 9999;
		}

		.user-menu:hover .user-dropdown-menu {
			display: block;
		}

		.user-info {
			font-size: 14px;
			color: #333;
		}
	</style>
	<style>
		/* Position nested submenu */
		.dropdown-submenu {
			position: relative;
		}

		.dropdown-submenu>.dropdown-menu {
			top: 0;
			left: 100%;
			/* Show to the right */
			margin-top: -1px;
		}

		/* Show submenu on hover */
		.dropdown-submenu:hover>.dropdown-menu {
			display: block;
		}
		
		
		.two-column-dropdown {
    		width: 420px;              /* adjust if needed */
   		    column-count: 2;
    		column-gap: 20px;
		}

		.two-column-dropdown li {
  		    break-inside: avoid;
		}

		.two-column-dropdown .nav-link {
    		white-space: normal;       /* allows long text wrap */
		}
	</style>
	

	<script>
		window.onload = function () {
			const jobId = sessionStorage.getItem("jobId");
			if (jobId) {
				startPolling(jobId);  // ✅ restart polling on every page load
			}
		};



		function startPolling(jobId) {
			const alertMsg = document.getElementById("alertMessage");
			function checkReport() {
				fetch('/BRRS/Reports/checkreport?jobId=' + encodeURIComponent(jobId))
					.then(res => res.text())
					.then(status => {
						if (status === "READY") {
							alertMsg.innerHTML = 'Report is ready!...';
							showAlert();
							downloadDetailfiles(jobId, filename);
							sessionStorage.removeItem("jobId");
							sessionStorage.removeItem("filename");
						}
						else if (status === "ERROR") {
							alertMsg.innerHTML = 'Error occurred. Contact administration.';
							showAlert();
							sessionStorage.removeItem("jobId");
							sessionStorage.removeItem("filename");
						}
						else {
							alertMsg.innerHTML = 'Download Is Processing…';
							showAlert();
							setTimeout(checkReport, 6000);
						}
					})

					.catch(err => {
						console.error("Error checking report:", err);
						alertMsg.innerHTML = 'Error checking report:' + err;
						showAlert();
						setTimeout(checkReport, 6000);
					});
			}

			checkReport();
		}

		function downloadDetailfiles(jobId, filename) {

			//$('#loader').modal('show');
			$.ajax({
				url: '/BRRS/Reports/downloaddetailExcel?jobId=' + jobId +
					'&filename=' + filename,
				type: 'GET',
				xhrFields: {
					responseType: 'blob'
				},
				success: function (data) {
					$('#loader').modal('hide');

					if (data && data.size > 100) {
						const blob = new Blob([data], { type: 'application/vnd.ms-excel' });
						const url = window.URL.createObjectURL(blob);
						const a = document.createElement('a');
						a.style.display = 'none';
						a.href = url;
						a.download = filename;
						document.body.appendChild(a);
						a.click();
						window.URL.revokeObjectURL(url);
						document.body.removeChild(a);

						showResultModal('Success', filename + ' downloaded successfully.');
					} else {
						showResultModal('Information', 'No data was available to create a download.');
					}
				},
				error: function (jqXHR, textStatus, errorThrown) {
					$('#loader').modal('hide');
					console.error("Download failed:", textStatus, errorThrown);
					showResultModal('Error', 'An error occurred while downloading the file. Please try again.');
				}
			});
		}

	</script>


	<script type="text/javascript">
		// this script is used for the download list next to file uploads
		function downloadFile() {
			alert("Download function not implemented yet.");
		}
	</script>

	<script>

		function showAlert() {
			const alertDiv = document.getElementById("autoHideAlert");
			alertDiv.style.display = "block";   // Show alert
			setTimeout(() => {
				hideAlert();                    // Auto-hide after 5 sec
			}, 7000);
		}

		function hideAlert() {
			const alertDiv = document.getElementById("autoHideAlert");
			alertDiv.style.display = "none";
		}

	</script>

	<script>
		function showUploadAlert(message, type = "info", isStatic = false) {
			const alertDiv = document.getElementById("UploadAlert");
			const alertMsg = document.getElementById("alertMessage");

			if (!alertDiv || !alertMsg) return;

			// Set message text
			alertMsg.innerHTML = message;

			// Reset and apply Bootstrap alert color classes
			alertDiv.classList.remove("alert-danger", "alert-success", "alert-warning", "alert-info");
			switch (type.toLowerCase()) {
				case "success":
					alertDiv.classList.add("alert-success");
					break;
				case "error":
					alertDiv.classList.add("alert-danger");
					break;
				case "warning":
					alertDiv.classList.add("alert-warning");
					break;
				default:
					alertDiv.classList.add("alert-info");
			}

			// Show the alert
			alertDiv.style.display = "block";

			// Auto-hide only if not static
			if (!isStatic) {
				alertDiv.hideTimer = setTimeout(() => {
					UploadhideAlert();
				}, 7000);
			}
		}

		function UploadhideAlert() {
			const alertDiv = document.getElementById("UploadAlert");
			if (alertDiv) {
				alertDiv.style.display = "none";
				if (alertDiv.hideTimer) clearTimeout(alertDiv.hideTimer);
			}
		}
	</script>

</head>

<body>
	<nav class="navbar full-navbar">
		<div class="navbar-container d-flex" style="width:100%">

			<!-- Logo -->
			<div class="logo-container">
				<img th:src="@{/images/botswana-logo.png}" alt="Bornfire" class="logo-img"
					style="width: 200px; height: 60px;">
			</div>

			<!-- Right content -->
			<div class="right-content flex-grow-1">
				<!-- Top row -->

				<div class=" d-flex justify-content-end align-items-center px-2 py-1 position-relative"
					th:style="'background-image: url(' + @{/images/rtbg.jpg} + '); background-size: cover; background-position: center; min-height: 35px;'">

					<!-- Bottom row: Menu -->
					<div class="px-5 py-1" style="height:40px;padding-right: 0px; ">
					<div class="btn-wrapper">
  						<button class="nav-arrow left" onclick="scrollBtns(-1)"><span style="font-size:25px">‹</span></button>
   						<div class="btn-container" id="btnContainer">
						<ul class="nav-links d-flex gap-4">
							<li class="nav-item"><a class="nav-link" th:href="@{/Dashboard}" id="Dashboard" onclick="contentLoad(this)"
									style=" text-align: center;">Home</a>
							</li>
							<li class="nav-item dropdown" style="text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'admin')}">

								<a href="#" class="dropdown-toggle">Admin</a>
								<ul class="dropdown-menu">
									<li>
										<a href="#" class="nav-link" id="UserProfile" onclick="contentLoad(this)">User
											Profile</a>
									</li>
									<li>
										<a href="#" class="nav-link" id="AccessandRoles"
											onclick="contentLoad(this)">Access And Roles</a>
									</li>
									<li>
										<a href="#" class="nav-link" id="BranchMaster" onclick="contentLoad(this)">Bank
											and Branch Master</a>
									</li>


									<!-- New Submenu: Report Parameter -->
									<li class="dropdown-submenu">
										<a href="#" class="nav-link">Report Parameter</a>
										<ul class="dropdown-menu">

											<li>
												<a href="#" class="nav-link" id="ReportMaster"
													onclick="contentLoad(this)">Report Master</a>
											</li>
											<li>
												<a href="#" class="nav-link" id="SourceDataMap"
													onclick="contentLoad(this)">Source Data</a>
											</li>
											<li>
												<a href="#" class="nav-link" id="ReferCodeMast"
													onclick="contentLoad(this)">Reference Code Master</a>
											</li>
											<li>
												<a href="#" class="nav-link" id="CommonMapping"
													onclick="contentLoad(this)">GL Configuration</a>
											</li>
										</ul>
									</li>
								</ul>
							</li>
							
							<li class="nav-item" style=" text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'AUDIT_US')}">

								<a href="#" class="dropdown-toggle" id="MCBL" onclick="contentLoad(this)">File
									Upload</a>
								<!-- <ul class="dropdown-menu">
								
								<li>
								<a  href="#" class="nav-link" id="MCBL"  onclick="contentLoad(this)">File Upload</a>
								</li>
								<li>
								<a  href="#" class="nav-link" id="BDGF"  onclick="contentLoad(this)">BDGF</a>
								</li>
								<li>
								<a  href="#" class="nav-link" id="BFDB"  onclick="contentLoad(this)">BFDB</a>
								</li>
								<li>
								<a  href="#" class="nav-link" id="BLBF"  onclick="contentLoad(this)">BLBF</a>
								</li>
							</ul> -->
							</li>


							<li class="nav-item dropdown" style="text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'BRRS_Reports')}">

								<a href="#" class="dropdown-toggle">BRRS Reports</a>
								<ul class="dropdown-menu">

									<!-- BRRS Reports Submenu -->
									<li class="dropdown-submenu">
										<a href="#" class="nav-link">Basel Returns</a>
										<ul class="dropdown-menu">
											<li>
												<a href="#" class="nav-link" id="BRRS"
													onclick="contentLoad(this)">Monthly Reports</a>
											</li>

											<li>
												<a href="#" class="nav-link" id="Quarterly"
													onclick="contentLoad(this)">Quarterly Reports</a>
											</li>
											<li>
												<a href="#" class="nav-link" id="HalfYearly"
													onclick="contentLoad(this)">Half Yearly Reports</a>
											</li>
										</ul>
									</li>
									
									<li class="dropdown-submenu">
										<a href="#" class="nav-link">RBR Reports</a>
										<ul class="dropdown-menu two-column-dropdown">
											<li>
												<a href="#" class="nav-link" id="PulaCFS"
													onclick="contentLoad(this)">Pula CFS</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="Pillar3Disclosure"
													onclick="contentLoad(this)">Pillar 3 Disclosure</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="LCR"
													onclick="contentLoad(this)">LCR</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="NSFR"
													onclick="contentLoad(this)">NSFR</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="CPR"
													onclick="contentLoad(this)">CPR</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="FSI"
													onclick="contentLoad(this)">FSI</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="AMLCFT"
													onclick="contentLoad(this)">AML-CFT</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="Top100borrower"
													onclick="contentLoad(this)">Top 100 borrower</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="DISBAnnualReturn"
													onclick="contentLoad(this)">DISB Annual Return</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="DISBBiannualReturn"
													onclick="contentLoad(this)">DISB Single Customer View Biannual Return</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="DISBMonthlyAndQuaterly"
													onclick="contentLoad(this)">DISB Monthly and Quaterly Returns</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="BGREPORT"
													onclick="contentLoad(this)">BG REPORT</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="UFCE"
													onclick="contentLoad(this)">UFCE</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" id="IRRBB"
													onclick="contentLoad(this)">IRRBB</a>
											</li>
											
											<li>
												<a href="#" class="nav-link" 
													onclick="contentLoad(this)">  </a>
											</li>
						
										</ul>
									</li>

								</ul>
							</li>




							<!---
<li class="nav-item dropdown" style=" text-align: center;" 
th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'BRRS_Reports')}">
 <a href="#" class="dropdown-toggle">Basel_Returns</a>
  <ul class="dropdown-menu"> <li><a href="#" class="nav-link" id="BRRS" onclick="contentLoad(this)">Basel Monthly Returns</a></li>
	 <li><a href="#" class="nav-link" id="Quarterly" onclick="contentLoad(this)">Basel Quarterly Returns</a></li> </ul> </li>
-->

							<!-- <li class="nav-item dropdown" style=" text-align: center;">
								<a href="#" class="dropdown-toggle">Resubmission</a>
								<ul class="dropdown-menu">
									<li>
										<a href="#" class="nav-link" id="BRRS" onclick="contentLoad(this)">Monthly
											Reports</a>
									</li>
									<li>
										<a href="#" class="nav-link" id="Quarterly"
											onclick="contentLoad(this)">Quarterly Reports</a>
									</li>
								</ul>
							</li> -->

							

							<li class="nav-item dropdown" style=" text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'Archival')}">

								<a href="#" class="dropdown-toggle">Archival</a>
								<ul class="dropdown-menu">
								
									<li class="dropdown-submenu">
											<a href="#" class="nav-link">Basel Returns</a>
	
											<ul class="dropdown-menu">
			
			
												<li><a href="#" class="nav-link" id="MonthlyArchival"
														onclick="contentLoad(this)">Monthly</a></li>
			
												<li><a href="#" class="nav-link" id="QuarterlyArchival"
														onclick="contentLoad(this)">Quarterly</a></li>
												<li>
													<a href="#" class="nav-link" id="HalfYearlyArchival"
														onclick="contentLoad(this)">Half Yearly</a>
												</li>
			
											</ul>
										</li>
	
									
									<li class="dropdown-submenu">
											<a href="#" class="nav-link">RBR Reports</a>
											<ul class="dropdown-menu two-column-dropdown">
												<li>
													<a href="#" class="nav-link" id="PulaCFSArchival"
														onclick="contentLoad(this)">Pula CFS</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="Pillar3DisclosureArchival"
														onclick="contentLoad(this)">Pillar 3 Disclosure</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="LCRArchival"
														onclick="contentLoad(this)">LCR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="NSFRArchival"
														onclick="contentLoad(this)">NSFR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="CPRArchival"
														onclick="contentLoad(this)">CPR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="FSIArchival"
														onclick="contentLoad(this)">FSI</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="AMLCFTArchival"
														onclick="contentLoad(this)">AML-CFT</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="Top100borrowerArchival"
														onclick="contentLoad(this)">Top 100 borrower</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBAnnualReturnArchival"
														onclick="contentLoad(this)">DISB Annual Return</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBBiannualReturnArchival"
														onclick="contentLoad(this)">DISB Single Customer View Biannual Return</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBMonthlyAndQuaterlyArchival"
														onclick="contentLoad(this)">DISB Monthly and Quaterly Returns</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="BGREPORTArchival"
														onclick="contentLoad(this)">BG REPORT</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="UFCEArchival"
														onclick="contentLoad(this)">UFCE</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="IRRBBArchival"
														onclick="contentLoad(this)">IRRBB</a>
												</li>
												
												<li>
													<a href="#" class="nav-link"
														onclick="contentLoad(this)">  </a>
												</li>
							
											</ul>
										</li>
									</ul>
							</li>
							
							<li class="nav-item dropdown" style=" text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'Archival')}">

								<a href="#" class="dropdown-toggle">Resubmission</a>
								<ul class="dropdown-menu">
								
									<li class="dropdown-submenu">
											<a href="#" class="nav-link">Basel Returns</a>
	
												<ul class="dropdown-menu">
				
				
													<li><a href="#" class="nav-link" id="Monthly1-Resubmission"
															onclick="contentLoad(this)">Monthly</a></li>
				
													<li><a href="#" class="nav-link" id="QuarterlyResub"
															onclick="contentLoad(this)">Quarterly</a></li>
															
													<li>
														<a href="#" class="nav-link" id="HalfYearlyResubmission"
															onclick="contentLoad(this)">Half Yearly</a>
													</li>
				
												</ul>
									</li>
									
									<li class="dropdown-submenu">
											<a href="#" class="nav-link">RBR Reports</a>
											<ul class="dropdown-menu two-column-dropdown">
												<li>
													<a href="#" class="nav-link" id="PulaCFSResubmission"
														onclick="contentLoad(this)">Pula CFS</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="Pillar3DisclosureResubmission"
														onclick="contentLoad(this)">Pillar 3 Disclosure</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="LCRResubmission"
														onclick="contentLoad(this)">LCR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="NSFRResubmission"
														onclick="contentLoad(this)">NSFR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="CPRResubmission"
														onclick="contentLoad(this)">CPR</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="FSIResubmission"
														onclick="contentLoad(this)">FSI</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="AMLCFTResubmission"
														onclick="contentLoad(this)">AML-CFT</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="Top100borrowerResubmission"
														onclick="contentLoad(this)">Top 100 borrower</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBAnnualReturnResubmission"
														onclick="contentLoad(this)">DISB Annual Return</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBBiannualReturnResubmission"
														onclick="contentLoad(this)">DISB Single Customer View Biannual Return</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="DISBMonthlyAndQuaterlyResubmission"
														onclick="contentLoad(this)">DISB Monthly and Quaterly Returns</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="BGREPORTResubmission"
														onclick="contentLoad(this)">BG REPORT</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="UFCEResubmission"
														onclick="contentLoad(this)">UFCE</a>
												</li>
												
												<li>
													<a href="#" class="nav-link" id="IRRBBResubmission"
														onclick="contentLoad(this)">IRRBB</a>
												</li>
												
												<li>
													<a href="#" class="nav-link"
														onclick="contentLoad(this)">  </a>
												</li>
							
											</ul>
										</li>
									</ul>
							</li>

							

						
							<!--  this list is for download option -->
							<!--<li class="nav-item" style=" text-align: center;"	
								th:if="${true}">
 th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'BRRS_Reports')}"> 
								<a href="#" class="dropdown-toggle" id="downloadbtn" onclick="downloadFile()">Download</a>


							</li>-->
                           <a href="#" class="dropdown-toggle" id="CONSOLIDATED_REPORT" onclick="contentLoad(this)">
                           BASEL RETURN DOWNLOAD</a>




							<li class="nav-item dropdown" style=" text-align: center;"
								th:if="${session.DOMAINID != null and #strings.containsIgnoreCase(session.DOMAINID, 'AUDIT_US')}">

								<a href="#" class="dropdown-toggle">Audit</a>
								<ul class="dropdown-menu">

									<li>
										<a href="#" class="nav-link" id="User_Audit" onclick="contentLoad(this)">User
											Audit</a>
									</li>
									<li>
										<a href="#" class="nav-link" id="Service_Audit"
											onclick="contentLoad(this)">Service Audit</a>
									</li>
								</ul>
							</li>
							<!-- <li class="nav-item dropdown" style=" text-align: center;">
							<a href="#" class="dropdown-toggle">BRRS Reports</a>
								<ul class="dropdown-menu">
								
								<li class="dropdown-submenu">
                            		<a href="#" class="nav-link">Fortnightly</a>
			                            <ul class="dropdown-menu">
			                                <li><a class="nav-link" >BRF1.12</a></li>
			                            </ul>
                        		</li>
								
								<li class="dropdown-submenu">
                            		<a href="#" class="nav-link">Monthly-1</a>
			                            <ul class="dropdown-menu">
			                                <li><a class="nav-link" th:href="@{/BRFValidations}" >BRF 1.1</a></li>
			                                <li><a class="nav-link" >BRF 1.2</a></li>
			                            </ul>
                        		</li>
								
								</ul>
								
								
						</li> -->
						
 


						</ul>
						</div>

   					<button class="nav-arrow right" onclick="scrollBtns(1)"><span style="font-size:25px">›</span></button>
					</div>
					</div>

					<!-- Centered Title -->
					<!--<h3 class="company-title position-absolute translate-middle-x"
			    style="top: 50%; left: 40%; font-weight: bold; font-family: 'Arial', cursive; font-size: 1.3rem;">
			    BCBUAE
			  </h3> -->

					<!-- User info -->
					<div class="user-section d-flex flex-column align-items-end ms-auto" style="width: fit-content;">
						<!-- <div class="company-small-title text-end" style="font-size: 0.75rem; font-weight: 600; color: #000; margin-right:40px;">
			      Bornfire Innovations Pvt Ltd
			    </div> -->
						<div class="d-flex align-items-center gap-1" style="font-size: 0.75rem;">
							<div class="user-details text-end">
								<strong>&nbsp;</strong> <img th:src="@{/images/Bornfire.png}" style="height:50px"
									alt="Bornfire">
							</div>
							<!-- <form th:action="@{/logout}" method="post" class="logout-btn m-0">
			        <button class="custom-tab-btn btn-outline-danger py-0 px-2" type="submit" style="font-size: 0.75rem;">
			          <i class="fas fa-sign-out-alt"></i> Logout
			        </button>
			      </form> -->

							<!-- Three-dot User Menu -->
							<div class="dropdown user-menu ms-3">
								<div class="three-dots" id="userMenuToggle">⋮</div>
								<div class="dropdown-menu user-dropdown-menu">
									<div class="user-info px-3 py-2">
										<div><strong> <span th:text="${session.USERID}"></span></strong></div>
										<div><strong><span th:text="${session.USERNAME}"></span></strong></div>
									</div>
									<div class="dropdown-divider"></div>
									<form th:action="@{/logout}" method="post" class="text-center mb-2">
										<button class="custom-tab-btn btn-outline-danger py-0 px-2" type="submit"><i
												class="fas fa-sign-out-alt"></i>Logout</button>
									</form>
								</div>
							</div>


						</div>
					</div>
				</div>



			</div>
		</div>
	</nav>

	<div class="modal fade" id="loader" data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
			<div class="modal-content" style="background: transparent;">
				<div class="modal-body" style="text-align: center">
					<div>
						<img th:src=@{/images/loader.gif} id="bfirelogo" style="width: 153px; height: auto; margin-left: 18px; background-color: transparent;
								border-color: transparent;" alt="Bornfire">
					</div>
				</div>
			</div>
		</div>
	</div>



	<div class="modal fade" id="excelModal" tabindex="-1" aria-labelledby="excelModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="excelModalLabel">Download Consolidated Report</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>

				<div class="modal-body">
					<form id="excelForm">
						<div class="mb-3">
							<label class="form-label">Ason Date</label>
							<input type="date" class="form-control" id="asondate">
						</div>

						<div class="mb-3">
							<label class="form-label">From Date</label>
							<input type="date" class="form-control" id="fromdate">
						</div>

						<div class="mb-3">
							<label class="form-label">To Date</label>
							<input type="date" class="form-control" id="todate">
						</div>

						<div class="mb-3">
							<label class="form-label">Currency</label>
							<input type="text" class="form-control" id="currency" value="FJD">
						</div>

						<div class="mb-3">
							<label class="form-label">Type</label>
							<select id="type" class="form-select">
								<option value="SUMMARY">SUMMARY</option>
								<option value="DETAIL">DETAIL</option>
							</select>
						</div>

						<div class="mb-3">
							<label class="form-label">Version</label>
							<input type="text" class="form-control" id="version" value="V1">
						</div>

						<div class="mb-3">
							<label class="form-label">Filename</label>
							<input type="text" class="form-control" id="filename" value="Consolidated_Report">
						</div>
					</form>
				</div>


				<!-- Error Modal -->
				<div class="modal fade" id="errorModal" tabindex="-1" aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered">
						<div class="modal-content" style="border-radius: 10px;">
							<div class="modal-header bg-danger text-white">
								<h5 class="modal-title">Error</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"
									aria-label="Close"></button>
							</div>
							<div class="modal-body" id="errorModalBody">
								<!-- Error message will be injected here -->
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
				</div>



				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-success" onclick="submitExcelDownload()">Download</button>
				</div>
			</div>
		</div>
	</div>


	<div class="alert alert-danger custom-alert" role="alert" id="autoHideAlert" style="display:none;">
		<button type="button" class="close" aria-label="Close" onclick="hideAlert()">
			<span aria-hidden="true">&times;</span>
		</button>
		<p id="alertMessage"><i class="fa fa-check-circle"></i> Download request received</p>
	</div>

	<div class="alert alert-danger custom-alert" role="alert" id="UploadAlert" style="display:none;">
		<button type="button" class="close" aria-label="Close" onclick="UploadhideAlert()">
			<span aria-hidden="true">&times;</span>
		</button>
		<p id="alertMessage"><i class="fa fa-check-circle"></i> Processed Successfully</p>
	</div>

</body>

<style>
	/* Ensure dropdown menu appears on top */
	.dropdown-menu {
		z-index: 1050 !important;
		/* Bootstrap default for modals */
		position: absolute !important;
	}

	/* Make sure parent containers don't hide overflow */
	.navbar,
	.navbar-container,
	.right-content,
	.bottom-row {
		position: relative;
		overflow: visible !important;
		z-index: auto;
	}
</style>
<script>
	document.addEventListener('DOMContentLoaded', function () {
		const toggle = document.getElementById('userMenuToggle');
		const menu = document.querySelector('.user-dropdown-menu');
		let autoCloseTimeout;

		toggle.addEventListener('click', function (e) {
			e.stopPropagation();

			// Toggle menu visibility
			if (menu.style.display === 'block') {
				menu.style.display = 'none';
				clearTimeout(autoCloseTimeout);
			} else {
				menu.style.display = 'block';


				autoCloseTimeout = setTimeout(() => {
					menu.style.display = 'none';
				}, 2000);
			}
		});

		// Close on outside click
		document.addEventListener('click', function () {
			menu.style.display = 'none';
			clearTimeout(autoCloseTimeout);
		});
	});
</script>
<script>
	// Called when user clicks on a menu item
	function contentLoad(a) {
		// Store ID of clicked element in localStorage
		localStorage.setItem("activeMenuId", a.id);

		// Show loader modal
		$('#loader').modal('show');

		// Delay navigation slightly so the loader is visible
		setTimeout(function () {
			location.href = "/BRRS/" + a.id;
		}, 300); // You can increase this delay if needed
	}

</script>

<script>
	// This runs on every page load
	document.addEventListener("DOMContentLoaded", function () {
		
		const currentPath = window.location.pathname;
        const homeId = "Dashboard"; 
        if (currentPath.includes("Dashboard")) {
            localStorage.setItem("activeMenuId", homeId);
        }
		const activeId = localStorage.getItem("activeMenuId");

		// Remove all existing active classes
		document.querySelectorAll(".nav-link").forEach(link => link.classList.remove("active"));

		if (activeId) {
			const activeLink = document.getElementById(activeId);
			if (activeLink) {
				activeLink.classList.add("active");

				// Also highlight parent .dropdown-toggle
				let dropdown = activeLink;
				while (dropdown = dropdown.closest('.dropdown-menu')) {
   					dropdown = dropdown.parentElement;
				    const toggle = dropdown.querySelector('a');
				    if (toggle) toggle.classList.add("active");
				}
			}
		}
	});
</script>

<script>
	function contentLoadExcel(a) {
		// Open the modal when the function is triggered
		$('#excelModal').modal('show');
	}

	function submitExcelDownload() {
		const asondate = $('#asondate').val();
		const fromdate = $('#fromdate').val();
		const todate = $('#todate').val();
		const currency = $('#currency').val();
		const type = $('#type').val();
		const version = $('#version').val();
		const filename = $('#filename').val();

		if (!asondate || !fromdate || !todate) {
			showErrorModal("⚠️ Please select all date fields before downloading.");
			return;
		}

		// Convert yyyy-mm-dd → dd/MM/yyyy
		const formatDate = date => {
			const [y, m, d] = date.split("-");
			return `${d}/${m}/${y}`;
		};

		const formattedAson = formatDate(asondate);
		const formattedFrom = formatDate(fromdate);
		const formattedTo = formatDate(todate);

		// Show loader modal
		$('#loader').modal('show');
		$('#excelModal').modal('hide');

		// Build request URL
		const url = `toDownloadExcel?asondate=${encodeURIComponent(formattedAson)}&fromdate=${encodeURIComponent(formattedFrom)}&todate=${encodeURIComponent(formattedTo)}&currency=${encodeURIComponent(currency)}&type=${encodeURIComponent(type)}&version=${encodeURIComponent(version)}&filename=${encodeURIComponent(filename)}`;

		// Fetch as a HEAD first to check if it exists
		fetch(url, { method: 'HEAD' })
			.then(response => {
				if (response.ok) {
					// If file is ready, redirect for download
					window.location.href = url;
				} else {
					throw new Error(`Server responded with status ${response.status} (${response.statusText})`);
				}
			})
			.catch(error => {
				console.error("Excel download failed:", error);
				showErrorModal("❌ Download Failed!<br><br>" + error.message);
			})
			.finally(() => {
				$('#loader').modal('hide');
			});
	}



	function showErrorModal(message) {
		$('#errorModalBody').html(message);
		$('#errorModal').modal('show');
	}
</script>
<script>
const container = document.getElementById("btnContainer");
const leftArrow = document.querySelector(".nav-arrow.left");
const rightArrow = document.querySelector(".nav-arrow.right");

function updateArrows() {
    const maxScroll = container.scrollWidth - container.clientWidth;

    leftArrow.style.display =
        container.scrollLeft <= 0 ? "none" : "block";

    rightArrow.style.display =
        container.scrollLeft >= maxScroll - 1 ? "none" : "block";
}

function scrollBtns(direction) {
    const scrollAmount = 140; 
    container.scrollLeft += direction * scrollAmount;
}

container.addEventListener("scroll", updateArrows);

window.addEventListener("load", updateArrows);
</script>



</html>